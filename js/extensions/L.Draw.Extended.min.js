import{jQuery as $}from"../jQuery/jquery3.4.1.js";import{L}from"../Leaflet/importer.js";import{K}from"../K.js";import{ID,switchLayerGroups,polyHoverAnimation}from"../functions/misc.js";import{createMarker}from"../functions/create-marker.js";L.Draw.Feature.include({enable:function(){this._disabled||this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},toggle:function(){this._enabled?(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type})):(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disabler:function(){return this._disabled=!0,this.disable(),this._updateDisabled(),this},enabler:function(){return this._disabled=!1,this._updateDisabled(),this},_updateDisabled:function(){this._button||(this._button=document.getElementsByClassName("leaflet-draw-draw-"+this.type)[0]),L.DomUtil.removeClass(this._button,"leaflet-disabled"),this._disabled&&L.DomUtil.addClass(this._button,"leaflet-disabled")}}),L.EditToolbar.Delete.include({enable:function(){this._disabled||!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disabler:function(){return this._disabled=!0,this.disable(),this._updateDisabled(),this},enabler:function(){return this._disabled=!1,this._updateDisabled(),this},_updateDisabled:function(){this._button||(this._button=document.getElementsByClassName(`leaflet-draw-edit-${this.type}`)[0]),L.DomUtil.removeClass(this._button,"leaflet-disabled"),this._disabled&&L.DomUtil.addClass(this._button,"leaflet-disabled")}}),L.EditToolbar.Edit.include({enable:function(){this._disabled||!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disabler:function(){return this._disabled=!0,this.disable(),this._updateDisabled(),this},enabler:function(){return this._disabled=!1,this._updateDisabled(),this},_updateDisabled:function(){this._button||(this._button=document.getElementsByClassName(`leaflet-draw-edit-${this.type}`)[0]),L.DomUtil.removeClass(this._button,"leaflet-disabled"),this._disabled&&L.DomUtil.addClass(this._button,"leaflet-disabled")}});export function drawEventCreated(e){let t=e.layer,a=e.layerType,i=K.settingShape(a),l=(K.local("copy")||{})[i]||{},s=l.p||{};if("marker"==a){let e=$("#marker-tools a.enabled");if(K.tool.marker.enabled()&&e.length){let a=e.attr("category"),i=e.attr("type"),l=K.tool.marker.layers[K.mode][a][i],r=l.o,n=$("#build-no").val(),d=$("#button-no").val();r.level={floor:+$(".outer.inputs input:checked").val()},n&&(r.level.unit=+n),d&&(r.level.btn=+d),s=l.p,t=createMarker(K.extend({},r,{id:ID(),latlng:t._latlng}))}else t=createMarker(K.extend(l.o,{id:ID(),latlng:t._latlng,shape:"marker"}))}else if("object"==K.type(l.o)){let e=t._latlng;"polyline"==a?e=t._latlngs.removeDupes():K.has(a,["polygon","rectangle"])&&(e=t._latlngs[0].removeDupes()),K.extend(l.o,{id:ID(),pane:"poly-hover"==l.o.className?"zonePane":"overlayPane",shape:a}),"circle"==a&&(l.o.radius=t._mRadius),t=L[a](e,l.o)}K.empty(s)||t.bindPopup(s),t.options.creator=K.user.name,t.options.group=t.options.group||"group08",K.group.addLayer(t),t.saved(!1),t.storeSettings(),K.map.type.add(t.options.type),switchLayerGroups(),polyHoverAnimation(),t.copy(!1)}
//# sourceMappingURL=L.Draw.Extended.min.js.map
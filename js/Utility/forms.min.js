import{hex_sha512}from"./sha512.js";import{K}from"../K.js";export function formhash(e,r){var a=document.createElement("input");e.appendChild(a),a.name="p",a.type="hidden",a.value=hex_sha512(r.value),r.value=""}export function regformhash(e,r,a,t,o){if(K.error="",""==r.value||""==a.value||""==t.value||""==o.value)return K.error="You must provide all the requested details.",!1;if(!(n=/^\w+$/).test(e.username.value))return K.error="Username must contain only letters, numbers and underscores.",e.username.focus(),!1;if(t.value.length<6)return K.error="Passwords must be at least 6 characters long.",e.password.focus(),!1;var n=/(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}/;if(!n.test(t.value))return K.error="Passwords must contain at least one number, one lowercase and one uppercase letter.",!1;if(t.value!=o.value)return K.error="Your password and confirmation do not match.",e.password.focus(),!1;var u=document.createElement("input");return $('[name="p"]').remove(),e.appendChild(u),u.name="p",u.type="hidden",u.value=hex_sha512(t.value),t.value="",o.value="",!0}export function resetformhash(e,r,a){if(K.error="",""==r.value||""==a.value)return K.error="You must provide all the requested details.",!1;if(r.value.length<6)return K.error="Passwords must be at least 6 characters long.",e.password.focus(),!1;if(!/(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}/.test(r.value))return K.error="Passwords must contain at least one number, one lowercase and one uppercase letter.",!1;if(r.value!=a.value)return K.error="Your password and confirmation do not match.",e.password.focus(),!1;var t=document.createElement("input");return $('[name="p"]').remove(),e.appendChild(t),t.name="p",t.type="hidden",t.value=hex_sha512(r.value),r.value="",a.value="",!0}
//# sourceMappingURL=forms.js.map
function pageLoad(){"true"==K.urlParam("noIcon")&&K.local("hideIcon",!0),"true"==K.urlParam("clean")&&K.local("cleanMenu",!0),K.local("hideIcon")||$("#survival-logo").fadeIn(500),K.local("cleanMenu")&&($(".side-menu-toggle.login").hide(0),$(".side-menu-toggle.filters").hide(0),$(".side-menu-toggle.full").hide(0),$(".side-menu-toggle.changes").hide(0),$(".side-menu-toggle.todo").hide(0),$(".side-menu-toggle.gear").hide(0),$(".side-menu-toggle.language").hide(0),$(".side-menu-toggle.shorts").hide(0),$(".leaflet-control-attribution.leaflet-control").hide(0),$("#logo").hide(0)),"true"==K.urlParam("overwolf")&&($(".side-menu-toggle.full").hide(0),$(".side-menu-toggle.changes").hide(0),$(".side-menu-toggle.todo").hide(0),$(".side-menu-toggle.language").hide(0),$(".side-menu-toggle.shorts").hide(0),$(".leaflet-control-attribution.leaflet-control").hide(0),$("#alert").hide(0),$("#logo").hide(0),$("#side-bar .side-menu-toggle.gear").css("top","170px")),$.ajax({url:"includes/get_markers.php"}).done(function(data){$.each($.parseJSON(data),function(i,v){K.settings.main.iconUrl.values[v]={shape:[]}})}),K.checkLogin(()=>{!K.user.donate&&!K.urlParam("overwolf")&&$("#alert").show(),K.user.donate&&$("#alert").hide(),$("#message").removeClass("master");let shorts=$("#side-bar .shorts .side-content");if(shorts.html(""),$(".side-menu-toggle.shorts").hide(),$.each(K.bar.b,function(i,v){empty(v)}),empty(K.drawControl),$("document").off("keypress"),$("#side-bar a.login").removeClass("out"),K.user.type){$("#side-bar a.login").addClass("out"),$("#message").addClass("master"),!K.urlParam("overwolf")&&$(".side-menu-toggle.shorts").show();let key=function(k,t){return`<div class="item">\n                    <div>${k}</div>\n                    <div class="grey">-</div>\n                    <span>${t.replace(" Survival","")}</span>\n                </div>`};shorts.append('<span class="title">Shortcuts</span>'),$.each(K.shortcuts,function(sub,a){shorts.append(`<span class="title sub">${sub.space()}</span>`),$.each(a,function(k,t){shorts.append(key(k,t.space()))})}),shorts.append(K.credits),K.bar.b.power=L.control.button({text:"",container:"power",title:"Enable/disable tools",css:"power",clickFn:function(){K.bar.b.power._click()}}).addTo(K.myMap),K.bar.b.power=$.extend(K.bar.b.power,{enabled:function(){return!$(this._button).hasClass("enabled")},_click:function(){let el=$(this._button),buttons=$(".leaflet-top.leaflet-left").children().not(".power").find("a");this.enabled()||K.check.doOnce?(el.addClass("enabled"),$.each(K.bar.draw,function(i,type){type.disabler()}),$("#marker-tools, .group-switch, #settings-menu").remove(),K.bar.b.group.disable(),K.bar.b.tools.disable(),switchLayerGroups(!0),$(buttons.get().reverse()).each(function(index,btn){setTimeout(function(){$(btn).css("transform","translateX(-50px)")},40*index)})):(buttons.each(function(index,btn){setTimeout(function(){$(btn).css("transform","translateX(0px)")},40*index)}),el.removeClass("enabled"),$.each(K.bar.draw,function(i,type){type.enabler()}),K.bar.b.group.enable(),K.bar.b.tools.enable(),switchLayerGroups()),K.local("powered",this.enabled()),K.check.doOnce=!1}}),K.bar.b.save=L.control.button().addTo(K.myMap).disable(),K.bar.b.group=L.control.button({text:"",title:"Switch editable layers",css:"group",clickFn:function(){if($(".group-switch").length)return void $(".group-switch").remove();$("body").append('<div class="leaflet-menu group-switch"></div>');let div=document.getElementsByClassName("group-switch")[0];L.DomEvent.disableClickPropagation(div),L.DomEvent.on(div,"mousewheel",L.DomEvent.stopPropagation),$.each(sortObjByKeys(K.map.type[K.mode]),function(category,types){$(".leaflet-menu").append(`<span class="leaflet-menu-item title">${category.space()}</span>`),$.each(sortObjByKeys(types),function(type,display){$(".leaflet-menu").append(`<a class="leaflet-menu-item switch-active-group \n                                ${K.map.active[type]?" active":""}" type="${type}">${type.space().replace(" Of "," of ")}</a>`)})}),$(".switch-active-group").on("click",function(e){let t=$(this).attr("type");$(this).toggleClass("active"),K.map.active[t]=!K.map.active[t],switchLayerGroups()})}}).addTo(K.myMap),K.bar.b.grid=L.control.button({text:"",title:"Grid modifier tools",css:"grid",clickFn:function(){let el=arguments[0]._button;if($("#slider-box").length)return void $("#slider-box").remove();let gridTools=["rotate","x-pos","y-pos"];$(el).after('<div id="slider-box"></div>'),$.each(gridTools,function(i,type){$("#slider-box").append(`<div class="leaflet-menu-slider">\n                            <div id="slider-${type}" class="slider-class ${type}">\n                                <div class="handle-${type} ui-slider-handle"></div>\n                            </div>\n                        </div>`),$("#slider-"+type).slider({min:"rotate"==type?-45:-100,max:"rotate"==type?45:100,step:"rotate"==type?.5:1,value:K.local(`grid-${type}`)||0,create:function(){let val=$(this).slider("value");$(".handle-"+type).text("rotate"==type?val+" deg":"x-pos"==type?"X: "+val:"Y: "+val)},slide:function(e,ui){$(".handle-"+type).text("rotate"==type?ui.value+" deg":"x-pos"==type?"X: "+ui.value:"Y: "+ui.value),K.local("grid-"+type,ui.value),setGridRotate()},change:function(e,ui){$(".handle-"+type).text("rotate"==type?ui.value+" deg":"x-pos"==type?"X: "+ui.value:"Y: "+ui.value),K.local("grid-"+type,ui.value),setGridRotate()}})}),$("#slider-box").append('<div class="slider-resets"></div>'),$.each(gridTools,function(i,type){$(".slider-resets").append(`<a class="slider-button reset-${type}">Reset ${type.firstToUpper()}</a>`),$(".slider-button.reset-"+type).on("click",function(){$("#slider-"+type).slider("value",0)})}),$(".slider-resets").append('<a class="slider-button reset-all">Reset All</a>'),$(".slider-button.reset-all").on("click",function(){$(".slider-class").slider("value",0)});let div=L.DomUtil.get("slider-box");L.DomEvent.disableClickPropagation(div),L.DomEvent.on(div,"mousewheel",L.DomEvent.stopPropagation)}}).addTo(K.myMap).disable(),K.bar.b.tools=L.control.button({text:"",title:"Toggle marker tool panel",css:"tools",clickFn:K.tool.marker.show}).addTo(K.myMap),K.updateMarker(),K.myMap.addControl(K.drawControl).on("draw:created",drawEventCreated),K.bar.draw.Polygon=K.drawControl._toolbars.draw._modes.polygon.handler,K.bar.draw.Polyline=K.drawControl._toolbars.draw._modes.polyline.handler,K.bar.draw.Rectangle=K.drawControl._toolbars.draw._modes.rectangle.handler,K.bar.draw.Marker=K.drawControl._toolbars.draw._modes.marker.handler,K.bar.draw.Circle=K.drawControl._toolbars.draw._modes.circle.handler,K.bar.edit.Edit=K.drawControl._toolbars.edit._modes.edit.handler,K.bar.edit.Remove=K.drawControl._toolbars.edit._modes.remove.handler,$(document).off("keypress"),$(document).on("keypress",keypressEvent),drawButtons=$(".leaflet-draw-section"),K.myMap.on("draw:editstart",function(e){polyHoverAnimation(!0),$("#settings-menu, .group-switch, #marker-tools").remove(),K.bar.b.power.disable(),K.bar.b.group.disable(),K.bar.b.save.disable(),K.bar.b.tools.disable(),K.myMap.addLayer(K.group.draw).addLayer(K.grid.overlay),K.bar.b.grid.enable(),setGridRotate(),K.bar.edit.Remove.disabler(),$.each(K.bar.draw,function(i,type){type.disabler()}),K.check.editing=!0,editIconMessage()}),K.myMap.on("draw:edited",function(e){e.layers.eachLayer(function(l){l.saved(!1)})}),K.myMap.on("draw:editstop",function(e){K.bar.b.power.enable(),K.bar.b.group.enable(),K.bar.b.tools.enable(),K.save.check(),K.myMap.removeLayer(K.grid.overlay),K.bar.b.grid.disable(),$("#slider-box").remove(),K.bar.edit.Remove.enabler(),$.each(K.bar.draw,function(i,type){type.enabler()}),K.check.editing=!1,polyHoverAnimation(),onZoomEnd(!0)}),K.myMap.on("draw:deletestart",function(e){K.check.deleting=!0,$.each(K.bar.b,function(i,type){type.disable()}),K.bar.edit.Edit.disabler(),$.each(K.bar.draw,function(i,type){type.disabler()}),K.myMap.addLayer(K.group.draw),setGridRotate()}),K.myMap.on("draw:deleted",function(e){$.each(e.layers._layers,function(i,l){K.group.draw.removeLayer(i),K.save.delete(l)})}),K.myMap.on("draw:deletestop",function(e){K.check.deleting=!1,K.bar.b.power.enable(),K.bar.b.group.enable(),K.save.check(),K.bar.edit.Edit.enabler(),$.each(K.bar.draw,function(i,type){type.enabler()}),onZoomEnd(!0)}),K.myMap.on("draw:drawstop",function(e){K.user.type>3||K.msg.show({msg:"Remember, you may have to zoom in to see the layers you create!",time:2500})})}K.user.type&&K.check.doOnce&&K.bar.b.power._onClick();const populateMap=function(e,id){let l,s=$.extend(!0,{},K.layer[e.t]||{}),g=e.g,o=$.extend({},s.o||{},e.o||{},{creator:e.c,id:id,shape:g.t}),p=$.extend({},s.p||{},e.p||{});if((e.p||{}).content&&delete p.list,(e.p||{}).list&&delete p.content,!o)return;if($.each(o.mode,function(mode,obj){"array"===K.type(obj)&&(o.mode[mode]={})}),o.type||(o.type=""),o.type&&!K.has(o.type,K.map.group[o.group])&&K.map.group[o.group].push(o.type),o.type&&o.mode&&o.shape){let filter=!1;if(K.user.type<1?o.type.contains("Complete")||"Error"==o.type||(filter=!0):K.user.type<=3?o.type.contains(K.user.name)?filter=!0:o.type.contains("Complete")||"Error"==o.type||(filter=!0):K.user.type>=4&&(filter=!0),filter){let val=o.fillColor;"marker"==o.shape&&(val=o.iconUrl),"polyline"==o.shape&&(val=o.color),K.map.type.counts[o.type]?K.map.type.counts[o.type]++:K.map.type.counts[o.type]=1,$.each(K.modes.get,function(i,mode){let cat=o.category||"Default",obj=K.map.type[mode];obj[cat]||(obj[cat]={}),K.in(mode,o.mode)&&(obj[cat][o.type]||(obj[cat][o.type]=[]),K.has(val,obj[cat][o.type])||(obj[cat][o.type].push(val),K.has(o.shape,["polygon","circle","rectangle"])&&obj[cat][o.type].push(o.color)))})}}for(s in o.mode in K.map.mode||(K.map.mode[o.mode]=[]),o.mode&&o.type&&!K.has(o.type,K.map.mode[o.mode])&&K.map.mode[o.mode].push(o.type),o)o[s]=toCorrectType(s,o[s]),"className"==s&&(o[s]=K.stripClasses(o[s])),K.settings.add(s,o[s],o.shape);let pCn=p.className?p.className:"";if(pCn&&!K.classRemoval.contains(pCn)&&(K.classRemoval=`${K.classRemoval.trim()} ${pCn}`),!K.classRemoval.contains(o.group)&&(K.classRemoval=`${K.classRemoval.trim()} ${o.group}`),"marker"==o.shape&&o.type){let obj={o:$.extend({},o,{className:(o.className||"").replace(/\w+ground/g,"").trim()}),p:p||{}};$.each(K.modes.get,function(i,mode){let tool=K.tool.marker.layers[mode];mode in o.mode&&(o.category in tool||(tool[o.category]={}),o.type in tool[o.category]||(tool[o.category][o.type]=obj),K.icons[o.type.space()]=obj.o.iconUrl)})}if("marker"!=g.t){let obj=$.extend(o,{pane:o.pane||("poly-hover"==o.className?"zonePane":"overlayPane")});"circle"==g.t&&(obj.radius=g.r),l=L[g.t](g.c,o)}else"marker"==g.t&&(l=createMarker($.extend(o,{latlng:g.c})));if(5==K.user.type&&p.content&&"poly-info"!=p.className&&p.content.bMatch("<p")){console.log(id,p);let el=$("<div />").append(p.content),list={title:!1,subs:[]};el.children().each(function(){if("P"==$(this).prop("nodeName")&&""!=$(this).text()){let item={};item.value=$(this).text(),"HR"==$(this).next().prop("nodeName")&&(item.line=!0),$(this).hasClass("desc")&&(item.color=!0),$(this).hasClass("note")&&(item.note=!0),list.subs.push(item)}$(this).remove()}),list.title=$(el).text().trim(),delete p.content,p.list=list,l.saved(!1)}(p&&K.in("content",p)||K.in("list",p))&&(l.bindPopup(p),K.user.type&&K.settings.add("className",p.className,o.shape,!0)),K.user.type&&(K.user.type>=4||o.creator.toLowerCase()==K.user.name.toLowerCase())&&l.on("click",K.tool.layer.show),o.complete&&"marker"===o.shape&&l.on("contextmenu",function(){this.toggleCompleted(!0)});let add=!1;K.user.type<1?o.type.contains("Complete")||"Error"==o.type||(add=!0):K.user.type<=3?o.type.contains(K.user.name)?add=!0:o.type.contains("Complete")||"Error"==o.type||(add=!0):K.user.type>=4&&(add=!0),add&&K.group.addLayer(l),l.markComplete()},populateMenus=function(){onZoomEnd(),K.user.type&&switchLayerGroups(),K.completeHidden=K.local("completeHidden")||!1;let sb="#side-bar .filters .side-content";$(sb).html(""),$(sb).append(`<a class="hide-all" title="Show/Hide all!"></a>\n                <span class="title">Filters</span>\n                <a class="hide-complete${K.completeHidden?' hidden">Show':'">Hide'} Complete</a>`);const list=sortObjByKeys(K.map.type[K.mode]);if(K.filters=K.local("filters")||{},$.each(list,function(category,types){K.length(types)&&(types=sortObjByKeys(types),$(sb).append(`<div class="sub title buttons">\n                        <a class="collapse">\n                            <span class="text">${category.firstToUpper()}</span>\n                            <span class="control icon" title="Collapse/Expand ${category}"></span>\n                        </a>\n                        <a class="control hide-some" category="${category}" title="Show/Hide all ${category}"></a>\n                    </div>`),$.each(types,function(type,i){let active=K.filters[type]||!1,el=$("<a />",{class:"side-bar-button "+(active?"inactive":""),set:category,label:type,html:$("<span />",{html:type.space().replace(/Dz/,"DZ").replace(/ (Survival|Complete)/,"").replace(" Of "," of ")})}).appendTo(sb);if($("<span />",{html:"[ x"+K.map.type.counts[type]+" ]",class:"quantity"}).appendTo(el),i[0].contains(".svg")){let src=i[Math.floor(Math.random()*i.length)];"MainMission"==type&&(src="images/marker-mission.svg"),"SideMission"==type&&(src="images/marker-mission-side.svg"),$("<img />",{src:src}).prependTo(el)}else"polyline"==category?$("<div />",{class:"polyline"}).css({backgroundColor:i[0]}).prependTo(el):$("<div />",{class:"polygon"}).css({borderColor:i[1],backgroundColor:i[0]}).prependTo(el);active&&showHideLayers(category,type,!0)}))}),$("#side-bar .side-bar-button").off("click").on("click",function(){$(this).toggleClass("inactive"),toggleHideIcons();let t=$(this).attr("label"),ia=$(this).hasClass("inactive");K.filters=K.local("filters")||{},K.filters[t]=ia,K.local("filters",K.filters),showHideLayers($(this).attr("set"),t,ia)}),$("#side-bar .hide-all").off("click").on("click",function(){showHideAllLayers(!$(this).hasClass("hidden")),toggleHideIcons()}),$("#side-bar .hide-some").off("click").on("click",function(){showHideCategory($(this).attr("category"),!$(this).hasClass("hidden")),toggleHideIcons()}),$("#side-bar .hide-complete").off("click").on("click",function(){K.completeHidden?($(this).removeClass("hidden").text("Hide Complete"),K.completeHidden=!1):($(this).addClass("hidden").text("Show Complete"),K.completeHidden=!0),K.local("completeHidden",K.completeHidde),K.complete.showHide()}),K.complete.showHide(),toggleHideIcons(),$("#side-bar .collapse").off("click").on("click",function(){let icon=$(".icon",this),list=$(this).parent().nextUntil(".sub.title");icon.hasClass("hidden")?(list.each(function(i,el){$(this).show(400)}),icon.removeClass("hidden")):(list.each(function(i,el){$(this).hide(400)}),icon.addClass("hidden"))}),$(sb).append(K.credits),K.local("sideBar")&&!K.local("cleanMenu")){let a=K.local("sideMenu");$("#side-bar, #side-bar ."+a).addClass("active "+a)}polyHoverAnimation(),$('[title!=""]').qtip({position:{viewport:$("#mapid"),my:"left center",at:"right center"},style:{classes:"tooltip-style"},show:{delay:250,solo:!0},hide:{event:"click mouseleave"},events:{hide:function(e,api){api.destroy(!0)}}}),$(document).on("mouseover",'[title!=""]',function(e){$(this).attr("title")&&($(this).removeAttr("oldtitle"),$(this).qtip("destroy",!0),$(this).qtip({position:{viewport:$("#mapid"),my:"left center",at:"right center"},style:{classes:"tooltip-style"},show:{delay:250,solo:!0},hide:{event:"click mouseleave"},events:{hide:function(e,api){api.destroy(!0)}}}),$(this).qtip("toggle",!0))}),setTimeout(function(){$("#survival-logo").fadeOut(1e3)},1e3),$(".paypalBtn").off("click").on("click",function(){$("#side-bar .filters .paypalBtn").closest("form").submit()})};$.ajax({type:"POST",url:"includes/file_exists.php",data:{data:K.user.name}}).done(function(a){a=$.parseJSON(a),K.userPath=a?"data/"+K.user.name+"/geoJSON.json":"data/empty.json",$.ajax({type:"POST",url:"includes/file_date.php",data:{path:K.userPath}}).done(function(data){data=$.parseJSON(data),$.getJSON(`${K.userPath}?v=${data.date}`,function(userJSON){$.ajax({type:"POST",url:"includes/file_date.php",data:{path:"data/geoJSON.json"}}).done(function(data){data=$.parseJSON(data),$.getJSON(`data/geoJSON.json?v=${data.date}`,function(geoJSON){$.each(K.group.feature,function(i,mode){$.each(mode,function(j,group){group.clearLayers(),K.myMap.removeLayer(group)})}),K.map.type.counts={},K.complete.layers=[],K.timed.layers=[],userJSON.features&&$.extend(geoJSON.features,userJSON.features),K.layer=$.extend({},geoJSON.settings,userJSON.settings||{}),$.each(K.layer,function(type,obj){$.each(obj.o,function(set,val){K.layer[type].o[set]=toCorrectType(set,val)})}),$.each(geoJSON.features,function(id,feature){populateMap(feature,id)})}).done(function(){populateMenus()})})})})})})}function doDonator(){$.ajax({type:"POST",url:"includes/process_donator.php",data:{email:$("#donator").val()}}).done(function(a){(a=$.parseJSON(a)).success?($("#side-bar .login .success").html(a.success),$("#side-bar .login .error").html(""),$("#donator").val("")):($("#side-bar .login .error").html(a.error),$("#side-bar .login .success").html(""))})}function doLogin(){_this=document.getElementById("login"),formhash(_this,_this.password),$.ajax({type:"POST",url:"includes/process_login.php",data:{email:_this.username.value,p:_this.p.value}}).done(function(a){K.local("username")&&(K.user.name=K.local("username"),K.user.type=K.local("usertype"),K.user.getData()),K.local("donate")?$("#alert").hide():$("#alert").show(),a&&($("#side-bar .login .side-content").html(a),K.check.doOnce=!0,pageLoad())})}function doRegister(){_this=document.getElementById("regform"),regformhash(_this,_this.username,_this.email,_this.password,_this.confirmpwd)?$.ajax({type:"POST",url:"includes/process_register.php",data:{username:_this.username.value,email:_this.email.value,p:_this.p.value}}).done(function(a){a=a.bMatch(/^(\{|\[])".*(\}|\])$/)?$.parseJSON(a):a,"object"==$.type(a)&&a.error?$("#side-bar .login .error").html(a.error):$("#side-bar .login .side-content").html(a)}):$("#side-bar .login .error").html(K.user.error)}function doReset(){_this=document.getElementById("reset"),resetformhash(_this,_this.password,_this.confirmpwd)?$.ajax({type:"POST",url:"includes/process_reset.php",data:{token:K.urlParam("token"),p:_this.p.value}}).done(function(a){a=a.bMatch(/^(\{|\[])".*(\}|\])$/)?$.parseJSON(a):a,"object"==$.type(a)&&a.error?$("#side-bar .login .error").html(a.error):window.location.href=window.location.href.split("?")[0]}):$("#side-bar .login .error").html(K.user.error)}function doForgot(){_this=document.getElementById("forgot"),$.ajax({type:"POST",url:"includes/process_forgot.php",data:{email:_this.email.value}}).done(function(a){let result=a.bMatch(/^(\{|\[])".*(\}|\])$/)?$.parseJSON(a):a;$.ajax({url:"includes/login.php"}).done(function(b){b&&$("#side-bar .login .side-content").html(b),"object"==$.type(result)&&(result.error&&$("#side-bar .login .error").html(result.error),result.success&&$("#side-bar .login .success").html(result.success))})})}function randomInt(min,max){return min=Math.ceil(min),max=Math.floor(max),Math.floor(Math.random()*(max-min))+min}function keypressEvent(e){if(!K.user.type||K.tool.layer.isOpen()||!K.bar.b.power.enabled())return;109==e.which?(e.preventDefault(),K.bar.draw.Marker.toggle()):114==e.which?(e.preventDefault(),K.bar.draw.Rectangle.toggle()):112==e.which?(e.preventDefault(),K.bar.draw.Polygon.toggle()):108==e.which&&(e.preventDefault(),K.bar.draw.Polyline.toggle());let quickAction=function(type){K.tool.marker.show(!0),$('#marker-tools a[type="'+type+'"]').trigger("click")},key=K.shortcuts.QuickMarker;115==e.which?(e.preventDefault(),quickAction(key.S)):49==e.which?(e.preventDefault(),quickAction(key[1])):50==e.which?(e.preventDefault(),quickAction(key[2])):51==e.which?(e.preventDefault(),quickAction(key[3])):52==e.which?(e.preventDefault(),quickAction(key[4])):53==e.which?(e.preventDefault(),quickAction(key[5])):101==e.which?(e.preventDefault(),quickAction(key.E)):97==e.which?(e.preventDefault(),quickAction(key.A)):102==e.which?(e.preventDefault(),quickAction(key.F)):100==e.which?(e.preventDefault(),quickAction(key.D)):113==e.which?(e.preventDefault(),quickAction(key.Q)):119==e.which?(e.preventDefault(),quickAction(key.W)):122==e.which?(e.preventDefault(),$('#marker-tools input[value=""]').prop("checked",!0),$("#marker-tools a").removeClass("underground overground")):120==e.which?(e.preventDefault(),$('#marker-tools input[value="underground"]').prop("checked",!0),$("#marker-tools a").removeClass("underground overground").addClass("underground")):99==e.which&&(e.preventDefault(),$('#marker-tools input[value="overground"]').prop("checked",!0),$("#marker-tools a").removeClass("underground overground").addClass("overground"))}function drawEventCreated(e){let layer=e.layer,type=e.layerType,shape=K.settingShape(type),copy=(K.local("copy")||{})[shape]||{},popup=copy.p||{},color;if("marker"==type){let selected=$("#marker-tools a.enabled");if(K.tool.marker.enabled()&&selected.length){let lvl=$('input[name="radio"]:checked').val(),cat=selected.attr("category"),typ=selected.attr("type"),j=K.tool.marker.layers[K.mode][cat][typ],p=j.o;lvl=lvl?" "+lvl:"",popup=j.p,color=K.empty(popup)?"":popup.className,layer=createMarker($.extend({},p,{id:ID(),latlng:layer._latlng,className:`${p.className}${lvl}`}))}else icon=copy?copy.o:K.map.defaults.marker,layer=createMarker($.extend(icon,{id:ID(),latlng:layer._latlng,shape:"marker"}))}else{let obj=copy.o||K.map.defaults[shape];if("object"==$.type(obj)){let ll=layer._latlng;"polyline"==type?ll=layer._latlngs.removeDupes():K.has(type,["polygon","rectangle"])&&(ll=layer._latlngs[0].removeDupes()),$.extend(obj,{id:ID(),pane:"poly-hover"==obj.className?"zonePane":"overlayPane",shape:type}),"circle"==type&&(obj.radius=layer._mRadius),layer=L[type](ll,obj)}}K.empty(popup)||layer.bindPopup(popup),layer.options.creator=K.user.name,layer.options.group=layer.options.group||"group08",K.group.addLayer(layer),layer.on("click",K.tool.layer.show),layer.options.complete&&"marker"===layer.options.shape&&layer.on("contextmenu",function(){this.toggleCompleted(!0)}),layer.saved(!1),layer.storeSettings(),switchLayerGroups(),polyHoverAnimation()}function setCollectionData(){$("#side-bar .img-check").removeClass("checked"),$.ajax({type:"POST",url:"includes/collection_data_get.php"}).done(function(a){if(Cookies.json=!0,setData=!!a.bMatch(/(\{|\[])".*(\}|\])/)&&$.parseJSON(a),!setData){let setData1=Cookies.getJSON("setData1"),setData2=Cookies.getJSON("setData2");"object"===$.type(setData1)&&"object"===$.type(setData2)&&(setData=$.extend({},setData1,setData2))}setData&&$.each(setData,function(index,val){val&&$(`#side-bar .img-check[name="${index}"]`).addClass("checked")}),updateSetCounter()})}function updateSetCounter(){$(".set-piece").each(function(index,el){let count=$(this).find(".img-check.checked").length;$(this).find(".counter").html(count||""),$(this).find(".set-bonus").removeClass("active");for(let i=count;i>0;i--)$(this).find(".set-bonus."+i).addClass("active")});let checks="#side-bar .img-check",total,got,left=$(checks).length-$(checks+".checked").length,counters=$("#side-bar .counter"),totalSets=counters.length,sets=0,m;counters.each(function(index,el){6==$(this).text()&&sets++});let setData={};$(checks).each(function(index,el){setData[$(this).attr("name")]=$(this).hasClass("checked")}),$("#side-bar .warning").html(""),K.user.type?$.ajax({type:"POST",url:"includes/collection_data_set.php",data:{setData:JSON.stringify(setData)}}):($("#side-bar .warning").html("This data is stored locally, if you would            like it to be persistant, please create an account or sign in."),K.local("setData",setData)),translator()}function empty(obj){"boolean"!=$.type(obj)&&(obj.remove(),obj=!1)}function removeEmpty(obj){let typ="array"==$.type(obj);return $.each(obj,function(i,v){K.has($.type(v),["object","array"])&&(obj[i]=removeEmpty(v));let t=$.type(v);("string"==t&&!v||"object"==t&&!K.length(v)||"array"==t&&!v.length||"function"==t)&&(typ?obj.splice(i,1):delete obj[i])}),obj}function sortObjByKeys(object){let keys=Object.keys(object),rObj={};return keys.sort(naturalCompare),$.each(keys,function(i,v){rObj[v]=object[v]}),rObj}function polyHoverAnimation(stop){let polys=$('path.leaflet-interactive:not(.poly-hover):not([fill="none"])');polys.off("mouseover mouseout"),stop||polys.on("mouseover",function(){let _this=$(this),cls=_this.attr("class").split(" ");$.each(cls,function(i,c){c.contains("phg")&&(_this=$("path."+c))}),_this.addClass("hover")}).on("mouseout",function(){let _this=$(this),cls=_this.attr("class").split(" ");$.each(cls,function(i,c){c.contains("phg")&&(_this=$("path."+c))}),_this.removeClass("hover")})}function editIconMessage(){let editIcon=$(".leaflet-editing-icon"),elMessage=$("#message"),elWarning;elMessage.children(".message").length||elMessage.append('<div class="message"></div>'),elWarning=elMessage.children(".message"),editIcon.length>1e3&&elWarning.text("There are "+editIcon.length+" editing icons, \t\tyou may want to switch groups to speed things up!"),elWarning.text(""),K.check.editing&&setTimeout(editIconMessage,2e3)}function setGridRotate(reset){let grid=$(".leaflet-overlay-pane").children().last();if("images/grid.svg"!=grid.attr("src"))return;let gridM=grid.css("transform").split(",");K.grid.x=!K.grid.x||reset?gridM[4]:K.grid.x,K.grid.y=!K.grid.y||reset?gridM[5].replace(")",""):K.grid.y,K.grid.r=K.local("grid-rotate")||0;let gridXAlt=K.local("grid-x-pos")||0,gridYAlt=K.local("grid-y-pos")||0;Number(K.grid.x),Number(K.grid.y),Number(K.grid.r),Number(gridXAlt),Number(gridYAlt);let css=`translate3d(${K.grid.x*(gridXAlt/1e5+1)}px, \n        ${K.grid.y*(gridYAlt/1e5+1)}px, 0px) rotate(${K.grid.r}deg)`;grid.css({transformOrigin:"center",transform:css})}function toggleHideIcons(){$("#side-bar .side-bar-button:not(.inactive)").length?$("#side-bar .hide-all").removeClass("hidden"):$("#side-bar .hide-all").addClass("hidden"),$("#side-bar .filters .side-content").children("").each(function(){if($(this).hasClass("sub")){let group=$(this).nextUntil(".sub, div"),count=0;group.each(function(){$(this).hasClass("inactive")&&count++}),$(".hide-some",this).removeClass("hidden"),count==group.length&&$(".hide-some",this).addClass("hidden")}})}function createMarker(p){!p.mode&&(p.mode={[K.mode]:{}});const i=K.getSetting(p,"iconUrl");return L.marker(p.latlng,$.extend(p,{icon:createIcon({iconUrl:i,iconSize:K.getSetting(p,"iconSize"),html:i?"":K.getSetting(p,"html"),className:K.getSetting(p,"className"),mode:p.mode}),shape:"marker",riseOnHover:!0,zIndexOffset:K.has(p.type,K.map.zIndex)?1e3:0}))}function createIcon(options){return L.divIcon($.extend({iconUrl:"",iconSize:"",html:"",className:"",done:!1,time:!1,mode:{}},options))}function showHideAllLayers(show){$.each(K.map.type[K.mode],function(category,array){$.each(array,function(type,i){let btn=$(`[set="${category}"][label="${type}"]`);btn.removeClass("inactive"),show&&btn.addClass("inactive"),K.filters=K.local("filters")||{},K.filters[type]=show,K.local("filters",K.filters),showHideLayers(category,type,show)})})}function showHideCategory(category,show){$.each(K.map.type[K.mode][category],function(type){let btn=$(`[set="${category}"][label="${type}"]`);btn.removeClass("inactive"),show&&btn.addClass("inactive"),K.filters=K.local("filters")||{},K.filters[type]=show,K.local("filters",K.filters),showHideLayers(category,type,show)})}function showHideLayers(category,type,h){let g,show,hide,group;switchLayerGroups(!0),$.each(K.map.group,function(grp,a){K.has(type,a)&&(g=K.group.mode[grp],show=h?K.group.mode.groupHidden:g,hide=h?g:K.group.mode.groupHidden,group=h?"groupHidden":grp,show&&hide&&hide.eachLayer(function(l){let i=l._leaflet_id;l.options.type==type&&l.options.category==category&&(show.addLayer(hide.getLayer(i)),hide.removeLayer(i),l.currentGroup=group)}))}),switchLayerGroups(),polyHoverAnimation()}function toCorrectType(setting,value){if(!K.settings.main[setting])return value;const type=K.settings.main[setting].type;return"number"==type?Number(value):"boolean"==type?"true"==value||"false"!=value&&!!value:("mode"==setting&&$.each(value,function(mode,val){K.empty(val)&&"array"==K.type(val)&&(value[mode]={})}),value)}function offset(latlng,oLat,oLng){return oLat&&(latlng.lat+=oLat),oLng&&(latlng.lng+=oLng),latlng}function textColor(hex){return hex=hex.substring(1),rgb=parseInt(hex,16),r=rgb>>16&255,g=rgb>>8&255,b=rgb>>0&255,luma=.2126*r+.7152*g+.0722*b,luma<40?"#ffffff":"#000000"}function switchLayerGroup(layer,oldGroup){const group=layer.options.group,id=layer._leaflet_id,groups=K.group.feature[K.mode];K.group.draw.removeLayer(id),groups[oldGroup].removeLayer(id),groups[group].addLayer(layer),$(layer._icon).removeClass(oldGroup).addClass(group)}function createPoint(e,f){return $.isArray(e)?L.point(e[0],e[1]):L.point(e,f)}function switchLayerGroups(d){$.each(K.group.draw._layers,function(i,l){l.editing.currentGroup=l.options.group,K.group.addLayer(K.group.draw.getLayer(i)),K.group.draw.removeLayer(i)}),!d&&$.each(K.group.mode,function(j,g){g.eachLayer(function(l){(K.map.active[l.options.type]&&(l.options.creator==K.user.name||K.user.type>3)||l.editing.edit)&&(l.editing.currentGroup="drawLayer",K.group.draw.addLayer(l),K.group.mode[l.options.group].removeLayer(l._leaflet_id))})}),K.myMap.removeLayer(K.group.draw).addLayer(K.group.draw).addLayer(K.group.mode.groupAll),onZoomEnd(!0)}function createGeoJSON(){$("#settings-menu").remove(),K.backup=K.user.name,K.checkLogin(()=>{const development=!1;if(K.backup!=K.user.name)return void alert("I'm sorry but your account information is incorrect, you cannot save your changes! Please log in and try again!");let feature;K.msg.show({msg:"SAVING...",dots:!0});const geoData={features:{},settings:{},deleted:K.save.deleted};switchLayerGroups(!0),$.each(K.layer,function(type,obj){const s=geoData.settings;obj.changed&&(!s[type]&&(s[type]={}),!K.empty(obj.o)&&(s[type].o=obj.o),!K.empty(obj.p)&&(s[type].p=obj.p))}),K.save.unsaved.eachLayer(function(layer){const o=layer.options,id=o.id,sets={},pop={},type=o.type;if($.each(o.mode,function(mode,obj){K.in("o",obj)&&K.empty(obj.o)&&delete obj.o,K.in("p",obj)&&K.empty(obj.p)&&delete obj.p}),layer.removeClass(K.classRemoval),feature={c:o.creator},type&&(feature.t=type),"circle"==o.shape?feature.g={t:"circle",c:K.valuesToString(layer._latlng),r:layer._mRadius.toString()}:"marker"==o.shape?(feature.g={t:"marker",c:K.valuesToString(layer._latlng)},o.iconUrl&&delete o.html,o.className=K.stripClasses(o.className)):feature.g={t:o.shape,c:K.valuesToString(layer._latlngs)},$.each(o,function(i,v){if(K.has(i,K.map.property[o.shape])){const sv=type&&K.layer[type]?K.layer[type].o[i]:"false",sm=K.settings.main;"false"!=sv&&K.equals(sv,v)||(sets[i]=i in sm&&"number"==$.type(sm[i])?v.toString():v)}}),!K.empty(sets)&&(feature.o=sets),layer.popup&&layer.popup.content||!K.empty(layer.popup.list)){const p=layer.popup,sv=K.layer[type]?K.layer[type].p:{};p.className!=sv.className&&(pop.className=p.className),p.list&&p.list.title?!K.equals(sv.list,p.list)&&(pop.list=p.list):sv.content!=p.content&&(pop.content=p.content),$.each(K.popupContent,function(k,s){pop.content==s&&(pop.content=k)})}!K.empty(pop)&&(feature.p=pop),geoData.features[id]=feature}),console.log("saved data...",geoData),$.ajax({type:"POST",url:"includes/write.php",data:{data:JSON.stringify(geoData)}}).done(function(a){a=a.bMatch(/^(\{|\[])".*(\}|\])$/)?$.parseJSON(a):a,"object"==$.type(a)&&a.message?alert(a.message):(K.bar.b.save.disable(),K.save.unsaved.clearLayers(),K.save.deleted=[],polyHoverAnimation(),K.msg.hide(),pageLoad())})})}function toggleFullScreen(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(Element.ALLOWKEYBOARD_INPUT)}function fixNum(s){return Number(s)?Number(s):s}function polyType(l){return 1==l.length&&4==l[0].length&&l[0][0].lat==l[0][3].lat&&l[0][0].lng==l[0][1].lng?"rectangle":l[0].lat?"polyline":"polygon"}function getType(o,g,a){if(!K.has(a,["marker","polyline","polygon"]))return"";let type="";return o=o.replace("images/",""),$.each(K.map.type,function(h,tg){$.each(tg[a],function(i,v){K.has(o,v)&&(type=i)})}),type}function getMode(type){return fMode="all",$.each(K.map.mode,function(mode,array){K.has(type,array)&&(fMode=mode)}),fMode}function setAllLayerClick(){let layers;K.group.feature[K.mode].everyLayer.eachLayer(function(l){l.off("click"),K.check.grabbing?l.on("click",function(){return this.options.id}):K.user.type&&(K.user.type>=4||l.options.creator.toLowerCase()==K.user.name.toLowerCase())&&l.on("click",K.tool.layer.show)})}function onZoomEnd(){setGridRotate(!0),zoom=K.myMap.getZoom();let classes="";for(let i=7;i<12;i++)classes+=` z${i}`;$("#mapid").removeClass(classes),$("#mapid").addClass(`z${Math.floor(zoom)}`),$.each(K.group.mode,function(g,n){let a=g.replace("group","");"number"==typeof(a=a.contains("_")?a.split("_"):a.bMatch(/\d+/)?Number(a):!K.has(a,["Hidden","Complete","everyLayer"])&&0)&&zoom>=a-1||"object"==typeof a&&zoom>=a[0]-1&&zoom<=a[1]+1?K.myMap.addLayer(K.group.mode[g]):K.myMap.removeLayer(K.group.mode[g])})}function urlExists(url,callback){$.ajax({type:"HEAD",url:url,success:function(){callback(!0)},error:function(){callback(!1)}})}function setSelectionRange(input,selectionStart,selectionEnd){if(input.setSelectionRange)input.focus(),input.setSelectionRange(selectionStart,selectionEnd);else if(input.createTextRange){let range=input.createTextRange();range.collapse(!0),range.moveEnd("character",selectionEnd),range.moveStart("character",selectionStart),range.select()}}function setCaretToPos(input,posA,posB){setSelectionRange(input,posA,posB||posA)}K.currentUpdate="18/06/2019",K.iconVersion="1",K.modes={get:["Story Mode","World Tier I","World Tier II","World Tier III","World Tier IV","World Tier V"]},K.keepPopupsOpen=!1,K.icons={Steel:"images/marker-crate-materials-steel.svg",Ceramics:"images/marker-crate-materials-ceramic.svg",Polycarbonate:"images/marker-crate-materials-polycarb.svg","Carbon Fibre":"images/marker-crate-materials-carbon.svg",Electronics:"images/marker-crate-materials-electro.svg",Titanium:"images/marker-crate-materials-titanium.svg",Trinket:"images/marker-crate-trinkets.svg"},L.Draw.Feature.include({enable:function(){this._disabled||this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},toggle:function(){this._enabled?(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type})):(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disabler:function(){return this._disabled=!0,this.disable(),this._updateDisabled(),this},enabler:function(){return this._disabled=!1,this._updateDisabled(),this},_updateDisabled:function(){let className="leaflet-disabled";this._button||(this._button=document.getElementsByClassName("leaflet-draw-draw-"+this.type)[0]),L.DomUtil.removeClass(this._button,className),this._disabled&&L.DomUtil.addClass(this._button,className)}}),L.EditToolbar.Delete.include({enable:function(){this._disabled||!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disabler:function(){return this._disabled=!0,this.disable(),this._updateDisabled(),this},enabler:function(){return this._disabled=!1,this._updateDisabled(),this},_updateDisabled:function(){let className="leaflet-disabled";this._button||(this._button=document.getElementsByClassName(`leaflet-draw-edit-${this.type}`)[0]),L.DomUtil.removeClass(this._button,className),this._disabled&&L.DomUtil.addClass(this._button,className)}}),L.EditToolbar.Edit.include({enable:function(){this._disabled||!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disabler:function(){return this._disabled=!0,this.disable(),this._updateDisabled(),this},enabler:function(){return this._disabled=!1,this._updateDisabled(),this},_updateDisabled:function(){let className="leaflet-disabled";this._button||(this._button=document.getElementsByClassName(`leaflet-draw-edit-${this.type}`)[0]),L.DomUtil.removeClass(this._button,className),this._disabled&&L.DomUtil.addClass(this._button,className)}}),L.Map.include({openPopup:function(popup,latlng,options){return popup instanceof L.Popup||(popup=new L.Popup(options).setContent(popup)),latlng&&popup.setLatLng(latlng),this.hasLayer(popup)?this:"marker"!=popup.options.type?(this._detail&&this._detail.options.autoClose&&this.closeDetail(),this._detail=popup,this.addLayer(popup)):(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=popup,this.addLayer(popup))},closePopup:function(popup){return popup&&popup!==this._popup||(popup=this._popup,this._popup=null),popup&&this.removeLayer(popup),this},closeDetail:function(popup){return popup&&popup!==this._detail||(popup=this._detail,this._detail=null),popup&&this.removeLayer(popup),this}}),L.Layer.include({openPopup:function(layer,latlng){if(layer instanceof L.Layer||(latlng=layer,layer=this),layer instanceof L.FeatureGroup)for(let id in this._layers){layer=this._layers[id];break}return this._popup._content?(this._popup.setContent(this._popup._content),latlng||(latlng=layer.getCenter?layer.getCenter():layer.getLatLng()),this._popup._content?(this._popup&&this._map&&(this._popup._source=layer,this._popup.update(),this._map.openPopup(this._popup,latlng)),this):this):this},bindPopup:function(){const a=arguments;let content=a[0],options=a[1]||{};"object"===$.type(a[0])&&(content=(options=a[0]).content),this.popup=options,content=this.getSetting("content",!0);let o={className:this.getSetting("className",!0),pane:"marker"==this.options.shape?"popupPane":"messagePane",list:this.getSetting("list",!0)||{},offset:L.point(-24,42),closeButton:!1,autoPan:!1,minWidth:15,maxWidth:300,type:this.options.shape};if(!content&&o.list.title&&(content=this.convertContent(o)),content instanceof L.Popup)L.setOptions(content,o),this._popup=content,content._source=this;else{if("object"==$.type(content)&&K.in("_content",content)&&!content._content)return this;content=(content||"").bMatch(/^\$/)?K.popupContent[content]:content,this._popup&&!o||(this._popup=new L.Popup(o,this)),this._popup.setContent(content)}return this._popupHandlersAdded||(this.on({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this.on("mouseover click focus",this._openPopup),!K.keepPopupsOpen&&"marker"==this.options.shape&&this.on("mouseout blur",this.closePopup),this._popupHandlersAdded=!0),this},convertContent:function(options){let list=options.list,html="",img,mark;return list.title&&(html+=list.title),$.each(list.subs,function(i,v){v.value&&(html+=`<p class="${v.color?"desc":""} ${v.note?"note":""}">\n                    ${K.in(v.value.toLowerCase(),K.svg)?K.svg[v.value.toLowerCase()]:""}${v.value}\n                </p>${v.line?"<hr>":""}`)}),list.list&&list.list[0]&&list.list[0].item&&(list.list.sort(function(a,b){return a.item<b.item?-1:a.item>b.item?1:0}),html+="<ul>",$.each(list.list,function(i,v){if(!v)return!0;mark=K.icons[v.item],html+=`<li>${img=`<img${mark?` src="${mark}"`:""}>`}<span>${v.item}</span><span class="qty">${v.qty>1?"(x"+v.qty+")":""}</span></li>`}),html+="</ul>"),html},closePopup:function(){return this._popup&&this._popup._content&&this._popup._close(),this},toggleCompleted:function(){this.options.complete&&(K.complete.toggle(this),this.markComplete())},setCompleted:function(done){this.options.complete&&(K.complete.set(done,this),this.markComplete())},markComplete:function(){if(!this.options.complete)return;let done=this.complete=K.complete.is(this),time;this.init||done?(this.init=!0,this.options.time&&done&&(K.complete.time(this)?K.timed.add(this):(K.complete.set(!1,this),K.timed.remove(this.options.id),done=this.complete=K.complete.is(this))),"marker"===this.options.shape&&this.updateIcon(),this.options.link&&$.each(this.getLinked(),function(){this.complete!=done&&this.setCompleted(done)}),done?K.complete.add(this):K.complete.remove(this.options.id),K.complete.showHide()):this.init=!0},getLinked:function(){let links=this.options.link;if(!links)return[];let layers=[];return K.group.feature[K.mode].everyLayer.eachLayer(function(l){K.has(l.options.id,links)&&layers.push(l)}),layers},addClass:function(value){let classes=classesToArray(value),cur,curValue,clazz,j,finalValue,className="marker"===this.options.shape?this.options.icon.options.className:this.options.className;if(classes.length&&(curValue=className||"",cur=` ${stripAndCollapse(curValue)} `)){for(j=0;clazz=classes[j++];)cur.indexOf(` ${clazz} `)<0&&(cur+=clazz+" ");curValue!==(finalValue=stripAndCollapse(cur))&&this.applySetting({setting:"className",value:finalValue,skipSave:!0})}return this},removeClass:function(value){let classes=classesToArray(value),cur,curValue,clazz,j,finalValue,className="marker"===this.options.shape?this.options.icon.options.className:this.options.className;if(classes.length&&(curValue=className||"",cur=` ${stripAndCollapse(curValue)} `)){for(j=0;clazz=classes[j++];)for(;cur.indexOf(` ${clazz} `)>-1;)cur=cur.replace(` ${clazz} `," ");curValue!==(finalValue=stripAndCollapse(cur))&&this.applySetting({setting:"className",value:finalValue,skipSave:!0})}return this}}),L.Polyline.include({initialize:function(latlngs,options){L.setOptions(this,options),K.in("shape",options)&&$.each(latlngs,(i,v)=>{v.lat=L.Util.formatNum(v.lat),v.lng=L.Util.formatNum(v.lng)}),this._setLatLngs(latlngs)}}),L.Circle.include({initialize:function(latlng,options,legacyOptions){if("number"==typeof options&&(options=L.extend({},legacyOptions,{radius:options})),L.setOptions(this,options),K.in("shape",options)&&(latlng.lat=L.Util.formatNum(latlng.lat),latlng.lng=L.Util.formatNum(latlng.lng),this.options.radius=L.Util.formatNum(this.options.radius)),this._latlng=L.latLng(latlng),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius}}),L.Marker.include({initialize:function(latlng,options){L.setOptions(this,options),K.in("shape",options)&&(latlng.lat=L.Util.formatNum(latlng.lat),latlng.lng=L.Util.formatNum(latlng.lng)),this._latlng=L.latLng(latlng),this.updateIcon()},updateIcon:function(options={}){if(!this.options.icon)return this;const i=this.getSetting("iconUrl");return this.options.icon=createIcon($.extend({iconUrl:i,iconSize:this.getSetting("iconSize"),html:i?"":this.getSetting("html"),className:this.getSetting("className"),done:K.complete.is(this),time:K.complete.time(this),layer:this},options)),this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this.popup),this}}),L.DivIcon.include({createIcon:function(oldIcon){const o=this.options,div=oldIcon&&"DIV"===oldIcon.tagName?oldIcon:document.createElement("div");if(div.innerHTML=K.getSetting(this.options,"html")||this.getIconHTML(),o.bgPos){var bgPos=L.point(o.bgPos);div.style.backgroundPosition=-bgPos.x+"px "+-bgPos.y+"px"}return this._setIconStyles(div,"icon"),div},getIconHTML:function(){const o=this.options;return`${K.getSetting(o,"className").contains("anim-icon")?'<img class="halo" src="images/_a.svg">':""} \n            <img src="${K.getSetting(o,"iconUrl")||""}" class="icon">\n            ${o.done&&!o.time?'<img src="images/complete.svg" class="done">':""}\n            ${o.done&&o.time?`<span class="time">${o.time}</span>`:""}\n            ${K.svg.dot}`.replace(/ {2,}/g," ")}}),L.Icon.include({_setIconStyles:function(img,name){const o=this.options,l=o.layer,iz=`${name}Size`,cn="className";let s=l.getSetting(iz);"number"===$.type(s)&&(s=[s,s]);let size=L.point(s),anchor=L.point("shadow"===name&&o.shadowAnchor||o.iconAnchor||size&&size.divideBy(2,!0));img.className=`leaflet-marker-${name} ${l.getSetting(cn)||""} ${l.getSetting(cn,!0)||""} ${l.getSetting("group")||""}`,anchor&&(img.style.marginLeft=-anchor.x+"px",img.style.marginTop=-anchor.y+"px"),size&&(img.style.width=size.x+"px",img.style.height=size.y+"px")}}),L.SVG.include({_initPath:function(layer){const path=layer._path=L.SVG.create("path"),o=layer.options;!K.in("mode",o)&&(o.mode={[K.mode]:{}});const m=!!K.in("o",o.mode[K.mode])&&o.mode[K.mode].o,cn="className",c=K.in(cn,m)?m[cn]:o[cn];c&&L.DomUtil.addClass(path,c),o.interactive&&L.DomUtil.addClass(path,"leaflet-interactive"),this._updateStyle(layer),this._layers[L.stamp(layer)]=layer},_updateStyle:function(layer){const path=layer._path,o=layer.options,m=!!K.in("o",o.mode[K.mode])&&o.mode[K.mode].o,stroke=K.in("stroke",m)?m.stroke:o.stroke,color=K.in("color",m)?m.color:o.color,opacity=K.in("opacity",m)?m.opacity:o.opacity,weight=K.in("weight",m)?m.weight:o.weight,fillColor=K.in("fillColor",m)?m.fillColor:o.fillColor,fillOpacity=K.in("fillOpacity",m)?m.fillOpacity:o.fillOpacity;path&&(stroke?(path.setAttribute("stroke",color),path.setAttribute("stroke-opacity",opacity),path.setAttribute("stroke-width",weight),path.setAttribute("stroke-linecap",o.lineCap),path.setAttribute("stroke-linejoin",o.lineJoin),o.dashArray?path.setAttribute("stroke-dasharray",o.dashArray):path.removeAttribute("stroke-dasharray"),o.dashOffset?path.setAttribute("stroke-dashoffset",o.dashOffset):path.removeAttribute("stroke-dashoffset")):path.setAttribute("stroke","none"),o.fill?(path.setAttribute("fill",fillColor||color),path.setAttribute("fill-opacity",fillOpacity),path.setAttribute("fill-rule",o.fillRule||"evenodd")):path.setAttribute("fill","none"))}}),L.SVG.include(L.Browser.vml?{_initPath:function(layer){const container=layer._container=L.SVG.create("shape"),o=layer.options,m=!!K.in("o",o.mode[K.mode])&&o.mode[K.mode].o,cn="className",c=K.in(cn,m)?m[cn]:o[cn];L.DomUtil.addClass(container,"leaflet-vml-shape "+(c||"")),container.coordsize="1 1",layer._path=L.SVG.create("path"),container.appendChild(layer._path),this._updateStyle(layer),this._layers[L.stamp(layer)]=layer},_updateStyle:function(layer){var lStroke=layer._stroke,lFill=layer._fill;const o=layer.options,container=layer._container,m=!!K.in("o",o.mode[K.mode])&&o.mode[K.mode].o,stroke=K.in("stroke",m)?m.stroke:o.stroke,color=K.in("color",m)?m.color:o.color,opacity=K.in("opacity",m)?m.opacity:o.opacity,weight=K.in("weight",m)?m.weight:o.weight,fill=K.in("fill",m)?m.fill:o.fill,fillColor=K.in("fillColor",m)?m.fillColor:o.fillColor,fillOpacity=K.in("fillOpacity",m)?m.fillOpacity:o.fillOpacity;container.stroked=!!stroke,container.filled=!!fill,stroke?(!lStroke&&(lStroke=layer._stroke=L.SVG.create("stroke")),container.appendChild(lStroke),lStroke.weight=weight+"px",lStroke.color=color,lStroke.opacity=opacity,o.dashArray?lStroke.dashStyle=L.Util.isArray(o.dashArray)?o.dashArray.join(" "):o.dashArray.replace(/( *, *)/g," "):lStroke.dashStyle="",lStroke.endcap=o.lineCap.replace("butt","flat"),lStroke.joinstyle=o.lineJoin):lStroke&&(container.removeChild(lStroke),layer._stroke=null),fill?(!lFill&&(lFill=layer._fill=L.SVG.create("fill")),container.appendChild(lFill),lFill.color=fillColor||color,lFill.opacity=fillOpacity):lFill&&(container.removeChild(lFill),layer._fill=null)}}:{}),L.DivOverlay.include({_updateContent:function(){if(this instanceof L.Popup&&this.options.list&&this.options.list.title&&(this._content=this.convertContent(this.options)),!this._content)return;let node=this._contentNode,content="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof content)node.innerHTML=content;else{for(;node.hasChildNodes();)node.removeChild(node.firstChild);node.appendChild(content)}this.fire("contentupdate")}}),L.Popup.include({_updateLayout:function(){let container=this._contentNode,style=container.style,width=container.offsetWidth,height=container.offsetHeight,words="",el=$(`<div>${this._content}</div>`);if(el.children().each(function(){words=` ${words.trim()} ${$(this).text()} `,$(this).remove()}),(words=`${words.trim()} ${$(el).text()}`.trim()).split(/ /).length>2)for(let i=width;i>1;i--)if(style.width=i+"px",container.offsetHeight>height){style.width=i+1+"px";break}style.whiteSpace="",style.height="";var maxHeight=this.options.maxHeight,scrolledClass="leaflet-popup-scrolled";maxHeight&&height>maxHeight?(style.height=maxHeight+"px",L.DomUtil.addClass(container,scrolledClass)):L.DomUtil.removeClass(container,scrolledClass),this._containerWidth=this._container.offsetWidth}}),L.Control.Button=L.Control.extend({options:{position:"topleft",container:"map",text:"",title:"Save to JSON",css:"save",clickFn:createGeoJSON},onAdd:function(map){let control="leaflet-control",options=this.options,el=control+" "+options.container+" leaflet-bar",container=document.getElementsByClassName(el)[0]||L.DomUtil.create("div",el);return this._button=this._createButton(options.text,options.title,control+"-"+options.css,container,this._onClick),container},onRemove:function(map){},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_onClick:function(e){this._disabled||this.options.clickFn(this)},_createButton:function(html,title,className,container,fn){let link=L.DomUtil.create("a",className,container);return link.innerHTML=html,link.href="#",link.title=title,link.setAttribute("role","button"),link.setAttribute("aria-label",title),L.DomEvent.on(link,"mousedown dblclick",L.DomEvent.stopPropagation).on(link,"click",L.DomEvent.stop).on(link,"click",fn,this),link},_updateDisabled:function(){let className="leaflet-disabled";L.DomUtil.removeClass(this._button,className),this._disabled&&L.DomUtil.addClass(this._button,className)}}),L.control.button=function(options){return new L.Control.Button(options)},K.local("mode")&&!K.has(K.local("mode"),["normal","Story"])||K.local("mode","Story Mode"),Cookies.json=!0,K.extend({lastCheck:!1,pane:{},tool:{},expires:{expires:28},classRemoval:"",checkLogin:function(callback){let end=new Date(K.lastCheck||"").getTime(),now,gap=(new Date).getTime()-end;!K.lastCheck||gap>6e4?$.ajax({url:"includes/check_login.php"}).done(function(a){a=$.parseJSON(a),K.user.name=a.username||!1,K.user.type=a.usertype||0,K.user.donate=a.donate||0,K.user.data=!1,K.user.name&&K.user.getData(),callback&&callback(),K.lastCheck=new Date}):callback&&callback()},complete:{layers:[],add:function(layer){let add=!0;$.each(this.layers,function(i,l){layer.options.id===l.options.id&&(add=!1)}),add&&this.layers.push(layer),K.timed.interval||K.timed.action()},remove:function(id){let index=!1;for(let i=0;i<this.layers.length;i++){const v=this.layers[i];if(id===v.options.id){index=i;break}}"number"===$.type(index)&&this.layers.splice(index,1)},is:function(layer){if(!layer.options.complete)return!1;let uD=K.user.data,id=layer.options.id;return uD||K.in("complete",K.local())||K.local("complete",{}),uD?K.in(id,uD):K.in(id,K.local("complete"))},time:function(layer){if(!this.is(layer))return!1;let uD=K.user.data,id=layer.options.id,time=uD?uD[id]:K.local("complete")[id];if("string"===$.type(time)){let end,now,gap=new Date(time).getTime()-(new Date).getTime(),hrs=Math.ceil(gap%864e5/36e5),min=Math.ceil(gap%36e5/6e4);gap<0?(this.set(!1,layer),time=!1):hrs?time=hrs+"h":min&&(time=min+"m")}else time=!1;return time},toggle:function(layer){return this.set(!layer.complete,layer)},set:function(done,layer){let uD=K.user.data,id=layer.options.id,time=layer.options.time;uD||K.in("complete",localStorage)||K.local("complete",{});let obj=uD||K.local("complete");return done?(obj[id]=!time||(new Date).addHours(time).toString(),this.add(layer)):(delete obj[id],this.remove(layer.options.id)),layer.complete=done,!uD&&K.local("complete",obj),uD&&(this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{$.ajax({type:"POST",url:"includes/write_complete.php",data:{data:JSON.stringify(K.user.data)}}).done(()=>{console.log("saved data!",K.user.data)})},1e3)),layer.complete},timeout:!1,showHide:function(){switchLayerGroups(!0);let h=K.completeHidden,layers=K.complete.layers,gC=K.group.mode.groupComplete,g,show,hide,i,hidden;K.filters=K.local("filters")||{},$.each(layers,function(x,layer){hidden=K.filters[layer.options.type],g=K.group.mode[hidden?"groupHidden":layer.options.group],i=layer._leaflet_id,show=h?gC:g,(hide=h?g:gC).getLayer(i)&&(show.addLayer(hide.getLayer(i)),hide.removeLayer(i))}),switchLayerGroups(),polyHoverAnimation()}},timed:{layers:[],interval:!1,add:function(layer){let add=!0;$.each(K.timed.layers,function(i,l){layer.options.id===l.options.id&&(add=!1)}),add&&K.timed.layers.push(layer)},action:function(){K.timed.interval=setInterval(()=>{if(!K.timed.layers.length)return clearInterval(K.timed.interval),void(K.timed.interval=!1);$.each(K.timed.layers,function(i,layer){layer.markComplete()}),K.complete.showHide()},6e4)},remove:function(id){let index=!1;for(let i=0;i<K.timed.layers.length;i++){const v=K.timed.layers[i];if(id===v.options.id){index=i;break}}"number"===$.type(index)&&K.timed.layers.splice(index,1)}},bar:{b:{save:!1,group:!1,grid:!1,tools:!1},draw:{},edit:{}},check:{editing:!1,deleting:!1,disabled:!1,doOnce:!0,grabbing:!1},drawControl:!1,group:{save:new L.FeatureGroup,draw:new L.FeatureGroup([],{makeBoundsAware:!1}),feature:{},addLayer:function(layer){if(!(layer instanceof L.Layer))return this;for(let mode in layer.options.mode)K.in(mode,this.feature)&&(this.feature[mode][layer.options.group].addLayer(layer),this.feature[mode].everyLayer.addLayer(layer));return this},removeLayer:function(layer,group){if(!(layer instanceof L.Layer))return this;!group&&(group=layer.options.group);for(let mode in layer.options.mode)this.feature[mode][group].removeLayer(layer),this.feature[mode].everyLayer.removeLayer(layer);return this}},grid:{overlay:L.imageOverlay("images/grid.svg",[[-19.05,-19.05],[19.05,19.05]]),x:0,y:0,r:0},save:{unsaved:new L.FeatureGroup,deleted:[],add:function(layer){this.unsaved.addLayer(layer),this.check()},remove:function(layer){this.unsaved.removeLayer(layer._leaflet_id),this.check()},delete:function(layer){this.remove(layer),this.deleted.push(layer.options.id),K.group.removeLayer(layer),this.check()},check:function(){return(r=K.length(this.unsaved._layers)+this.deleted.length)?K.bar.b.save.enable():K.bar.b.save.disable(),r}},map:{active:[],group:{everyLayer:[],groupAll:[],groupHidden:[],groupComplete:[],group08:[],group09:[],group10:[],group11:[],group12:[]},type:{counts:{}},mode:{},property:{polygon:["category","color","weight","opacity","fillColor","fill","fillOpacity","stroke","group","type","className","mode","complete"],circle:["category","color","weight","opacity","fillColor","fill","fillOpacity","stroke","group","type","className","mode","complete"],rectangle:["category","color","weight","opacity","fillColor","fill","fillOpacity","stroke","group","type","className","mode","complete"],polyline:["category","color","weight","opacity","stroke","complete","group","type","className","mode"],marker:["category","group","type","time","iconSize","html","mode","complete","link","iconUrl","className"],popup:["className"]},defaults:{marker:{category:"default",className:"anim-icon",group:"group08",iconSize:[22,22],iconUrl:"images/marker-poi-contaminated.svg",mode:{[K.mode]:{}},shape:"marker",type:"Contaminated"},polygon:{category:"default",className:"",color:"#c22e2e",fill:1,fillColor:"#672f2f",fillOpacity:.05,group:"group08",mode:{[K.mode]:{}},opacity:.4,pane:"overlayPane",shape:"polygon",smoothFactor:1,stroke:1,type:"ContaminatedZone",weight:1},rectangle:{category:"default",className:"",color:"#c22e2e",fill:1,fillColor:"#672f2f",fillOpacity:.05,group:"group08",mode:{[K.mode]:{}},opacity:.4,pane:"overlayPane",shape:"rectangle",smoothFactor:1,stroke:1,type:"ContaminatedZone",weight:1},circle:{category:"default",className:"",color:"#c22e2e",fill:1,fillColor:"#672f2f",fillOpacity:.05,group:"group08",mode:{[K.mode]:{}},opacity:.4,pane:"overlayPane",shape:"circle",smoothFactor:1,stroke:1,type:"ContaminatedZone",weight:1},polyline:{category:"default",color:"#207e70",group:"groupAll",mode:{[K.mode]:{}},opacity:1,pane:"overlayPane",shape:"polyline",smoothFactor:1,stroke:1,type:"",weight:5}},zIndex:["PointOfInterest","Hideout","Contaminated","Landmark","CrashSite"]},settings:{add:function(setting,value,shape,popup){K.isArray(value)&&(value=value.join(","));let i=this[popup?"popup":"main"][setting]||!1;i&&K.in("values",i)&&(i=i.values),!K.empty(value)&&i&&(shape=K.settingShape(shape),!(value in i)&&(i[value]={shape:[]}),!K.has(shape,i[value].shape)&&i[value].shape.push(shape))},main:{category:{values:{},description:"Categories are used to organize the filter menu.",for:["marker","polygon","polyline","circle","rectangle"],type:"string"},type:{values:{},description:"Type is used for both the filter menu and to make it easier to change settings in bulk.",for:["marker","polygon","polyline","circle","rectangle"],type:"string"},mode:{description:"Mode is used to suggest what map mode the layers are for.\n\nAs the modes are created they will be added to the list bellow.\n\nWhen more than one mode is selected, most other options will have a new mode switch to allow that option to be changed leaving the original the same.",for:["marker","polygon","polyline","circle","rectangle"],type:"object"},group:{values:{},description:"Group is used to set what zoom level of the map the layer will appear on.\nThere are set options from Group08 to Group12 with a GroupAll to never hide the layer.",for:["marker","polygon","polyline","circle","rectangle"],type:"string"},className:{values:{},description:"Class Name is the element class added to the layer, this is used for the marker level (overground/underground) and the hover effect.",for:["marker","polygon","polyline","circle","rectangle"],type:"string"},fill:{values:{true:{shape:[]},false:{shape:[]}},description:"Fill is used to say if a shape has a fill color.",for:["polygon","circle","rectangle"],type:"boolean"},fillColor:{values:{},description:"Fill Color is used to set the color of the filled shape.",for:["polygon","circle","rectangle"],type:"string"},fillOpacity:{values:{},description:"Fill Opacity is used to set the opacity of the filled shape.",for:["polygon","circle","rectangle"],type:"number"},iconUrl:{values:{},description:"Icon URL is to set the URL of the required icon, although you can use external icons, it is recommended to use one from the list bellow.",for:["marker"],type:"string"},iconSize:{values:{},description:"Icon Size is used to set the icon size, it should always be two of the same number, e.g. '26, 26'.",for:["marker"],type:"array"},html:{description:"HTML shouldn't be used unless you know what you are doing, this is used to create the layers that show the street names.",for:["marker"],type:"string"},stroke:{values:{true:{shape:[]},false:{shape:[]}},description:"Stroke is used to set if the shape has a stroke or not.",for:["polygon","circle","rectangle"],type:"boolean"},color:{values:{},description:"Color is the stroke color for the shape.",for:["polygon","polyline","circle","rectangle"],type:"string"},opacity:{values:{},description:"Opacity is used to set the opacity of the Stroke.",for:["polygon","polyline","circle","rectangle"],type:"number"},weight:{values:{},description:"Weight is used to set the thickness of the Stroke.",for:["polygon","polyline","circle","rectangle"],type:"number"},complete:{values:{true:{shape:[]},false:{shape:[]}},description:"Complete is used to show that a layer can be marked by the user as completed.",for:["marker","polygon","polyline","circle","rectangle"],type:"boolean"},time:{values:{},description:"Time is used in conjunction with Complete to only set a layer as complete for this length of time. This is helpful for things that can be collected again at a later date. For this to work Complete must be 'True'.",for:["marker"],type:"number"},link:{description:"Link is used in conjunction with Complete to also hide the linked layer(s) after the this layer has been completed. The ID of the layers are required to link them. The list should be comma separated.",for:["marker"],type:"array"},id:{description:"The ID is set automatically and should never be changed. It is used to identify the layer in the data file to update it with changes.",for:["marker","polygon","polyline","circle","rectangle"],type:"string"}},popup:{className:{values:{},description:"Class Name is used to set the color of the title in the Popup and it also sets the popup to be in the top left corner with the poly-hover class.",for:["marker","polygon","polyline","circle","rectangle"],type:"string"},content:{description:"Content can be used for the Popups Content, it is preferred to use the List for this though as that uses less storage space and automatically creates the HTML content for the Popup. Any HTML can be used here.",for:["marker","polygon","polyline","circle","rectangle"],type:"string"},list:{description:"This is an alternative to content, with this it will automatically arrange the content to display correctly in the html tags with images included. Filling this out will remove whatever is in content.",for:["marker","polygon","polyline","circle","rectangle"],type:"object"}}},mode:K.local("mode")||"Story Mode",msg:{note:$(".notification"),show:function(options){$.proxy(K.msg._show(options),K.msg)},_show:function(options){options=$.extend({msg:"",time:0,dots:!1},options);let dot='<div class="dot"></div>';this.note.length||($("body").append('<div class="notification"></div>'),this.note=$(".notification")),options.msg&&(this.timeout&&clearTimeout(this.timeout),this.note.removeClass("dots"),options.dots&&this.note.addClass("dots"),this.note.html(options.msg+(options.dots?'<div class="dot-box">'+dot+dot+dot+dot+dot+"</div>":"")),this.note.fadeIn(500),options.time&&(this.timeout=setTimeout(this.hide,options.time)))},hide:function(){$.proxy(K.msg._hide(),K.msg)},_hide:function(){this.note.fadeOut(500),this.timeout=!1},timeout:!1},myMap:L.map("mapid",{center:K.local("pan")||[0,0],zoom:K.local("zoom")||7,minZoom:7,maxZoom:15,maxBounds:[[8.3,-14.9],[-8.3,14.9]],zoomSnap:.25,zoomDelta:.5,wheelPxPerZoomLevel:100,zoomControl:!1,attributionControl:!0}),popupContent:{},shortcuts:{Draw:{M:"Marker",P:"Polygon",R:"Rectangle",L:"Polyline"},QuickMarker:{1:"Airdrop",2:"ComponentZone",3:"FoodZone",4:"WaterZone",5:"Artifact",E:"Comms",A:"Echo",F:"Food",D:"Water",S:"Component",W:"Weapon",Q:"Gear",Z:"GroundLevel",X:"Underground",C:"Overground"}},user:{name:!1,type:0,error:!1,data:!1,getData:function(){K.user.name&&$.ajax({url:"includes/data_exists.php"}).done(function(data){K.user.data={},(data=$.parseJSON(data))&&$.getJSON(`data/${K.user.name}/complete.json?v=${data}`,function(data){K.local("complete")&&($.extend(data,K.local("complete")),localStorage.removeItem("complete"),$.ajax({type:"POST",url:"includes/write_complete.php",data:{data:JSON.stringify(data)}})),K.user.data=data})})}},updateMarker:function(icon){const copy=K.local("copy")||{};let o=(icon=icon||(K.in("marker",copy)?copy.marker.o:{}))||{},url="images/marker-poi-contaminated.svg",options={iconSize:o.iconSize||[22,22],iconUrl:o.iconUrl||url,html:o.html||`<img class='halo' src='images/_a.svg'><img src='${o.iconUrl||url}' class='icon'>`,className:o.className||"anim-icon"};if(K.drawIcon)$.extend(K.drawIcon.options,options);else{let icon=L.Icon.extend({options:options});K.drawControl=new L.Control.Draw({draw:{marker:{icon:new icon}},edit:{featureGroup:K.group.draw,selectedPathOptions:{maintainColor:!0,moveMarkers:!0}}}),K.drawIcon=K.drawControl.options.draw.marker.icon}},svg:{dot:'<svg class="bg-dot" viewBox="0 0 64 64"><path class="dot-color" d="M32,3.1C16.039,3.1,3.1,16.039,3.1,32c0,15.961,12.939,28.9,28.9,28.9c15.961,0,28.9-12.939,28.9-28.9 C60.9,16.039,47.961,3.1,32,3.1z M32,48.5c-9.113,0-16.5-7.387-16.5-16.5S22.887,15.5,32,15.5S48.5,22.887,48.5,32 S41.113,48.5,32,48.5z"/></svg>',"black tusk":'<svg class="icon-npc black-tusk" viewBox="0 0 64 64"><path class="st0" d="M32 1.5l-30.5 30.5 30.5 30.5 30.5-30.5-30.5-30.5zm-20.57 30.5l17.94-17.94v18.06l-4.71 4.71 7.34 7.34 7.34-7.34-4.71-4.71v-18.06l17.94 17.94-20.57 20.57-20.57-20.57z"/></svg>',"true sons":'<svg class="icon-npc true-sons" viewBox="0 0 64 64"><path d="M4.5 55.6h34.8l-13.4-33.1h-21.4zm27.1-37.9l3 5.6h24.9v-5.6zm5.3 10l3 5.6h19.6v-5.6zm-10.2-19.3l2.6 5h30.2v-5zm15.5 29.3l3 5.7h14.3v-5.7z"/></svg>',hyenas:'<svg class="icon-npc hyenas" viewBox="0 0 64 64"><path d="M48 24.1l11.5-4.5-1.4-3.5-7.1 2.9 3.8-7-3.2-1.8-6 11-13.6 5.3-14.2-4.8-5.5-9.6-3.4 1.9 3.4 6-6.6-2.3-1.2 3.5 10.6 3.6 4 6.9-11.7 4.6 1.4 3.5 12.1-4.9 10.8 19 10.9-19.9 12 4 1.1-3.5-11.3-3.8 3.7-6.7zm-5.4 2.2l-1.8 3.3-3.5-1.2 5.3-2.1zm-22.1.3l6 2-4 1.7-2-3.7zm11.2 19.6l-7.3-12.7 7.6-3 7 2.4-7.3 13.3z"/></svg>',outcasts:'<svg class="icon-npc outcasts" viewBox="0 0 64 64"><path d="M59.109 18.941a.986.986 0 0 0-.114-.296c-.262-.441-.821-.592-1.248-.338a.898.898 0 0 0-.427.864c.53 4.26-1.419 8.621-5.331 10.947-5.279 3.139-12.115 1.385-15.267-3.917-3.152-5.302-1.428-12.145 3.85-15.284 3.912-2.326 8.675-1.955 12.163.546.284.192.657.22.963.037.428-.254.562-.817.299-1.258a1 1 0 0 0-.205-.242c-4.76-4.16-11.48-5.174-16.808-2.007a13.165 13.165 0 0 0-4.37 4.242 1.186 1.186 0 0 1-1.967.07 13.16 13.16 0 0 0-4.489-3.817c-5.503-2.851-12.153-1.444-16.661 2.987a.982.982 0 0 0-.19.253c-.235.455-.07 1.01.372 1.238a.895.895 0 0 0 .959-.094c3.337-2.701 8.069-3.349 12.111-1.256 5.454 2.825 7.575 9.556 4.738 15.033s-9.559 7.629-15.013 4.804c-4.041-2.094-6.242-6.333-5.962-10.617a.893.893 0 0 0-.477-.837c-.441-.229-.99-.044-1.227.411a.999.999 0 0 0-.097.301c-1.018 6.238 1.67 12.481 7.174 15.332a13.108 13.108 0 0 0 4.183 1.337 1.17 1.17 0 0 1 .921 1.587 13.862 13.862 0 0 0-.934 4.999c0 6.394 4.306 11.819 10.315 13.847a.93.93 0 0 0 .718-1.708c-3.933-1.776-6.685-5.803-6.685-10.499 0-3.951 1.945-7.435 4.903-9.499v8.551a1.443 1.443 0 0 0 2.884 0v-9.989a10.9 10.9 0 0 1 1.83-.415v11.189a1.647 1.647 0 1 0 3.294 0v-11.161c.629.101 1.241.252 1.83.456v9.272a1.442 1.442 0 1 0 2.884 0v-7.76c2.849 2.08 4.714 5.489 4.714 9.353 0 4.696-2.752 8.724-6.685 10.499a.93.93 0 1 0 .718 1.708c6.007-2.028 10.315-7.454 10.315-13.847 0-2.053-.452-4.003-1.256-5.777a1.185 1.185 0 0 1 1.016-1.691 13.214 13.214 0 0 0 5.998-1.83c5.323-3.166 7.642-9.555 6.261-15.724zm-25.193 12.743h-4.196a1.048 1.048 0 0 1-.911-1.564l2.098-3.705a1.048 1.048 0 0 1 1.823 0l2.098 3.705a1.048 1.048 0 0 1-.912 1.564zM12.618 29.146l4.804-5.045 4.58 4.434 2.291-2.366-4.6-4.453 4.904-5.15-2.384-2.273-4.886 5.131-4.756-4.606-2.291 2.366 4.776 4.626-4.822 5.063zm38.473-15.853l-4.887 5.131-4.756-4.606-2.291 2.366 4.776 4.625-4.822 5.064 2.384 2.272 4.805-5.045 4.58 4.435 2.291-2.366-4.6-4.454 4.904-5.149z"/></svg>'},stripClasses:function(value){let classes=classesToArray(K.classRemoval),cur,curValue,clazz,j,finalValue,className=value;if(classes.length&&(cur=` ${stripAndCollapse(curValue=className||"")} `)){for(j=0;clazz=classes[j++];)for(;cur.indexOf(` ${clazz} `)>-1;)cur=cur.replace(` ${clazz} `," ");finalValue=stripAndCollapse(cur)}return finalValue},valuesToString:obj=>K.has($.type(obj),["object","array"])?($.each(obj,function(i,v){"function"!=$.type(v)&&(obj[i]=K.has($.type(v),["object","array"])?K.valuesToString(v):v.toString())}),obj):obj.toString(),data:{types:{}},settingShape:shape=>K.has(shape,["polyline","rectangle"])?"polygon":shape,getSetting:(obj,setting)=>{const m=!(!K.in("mode",obj)||!K.in("o",obj.mode[K.mode]))&&obj.mode[K.mode].o;return m&&K.in(setting,m)?m[setting]:obj[setting]}}),K.modes.create=function(){$.each(this.get,function(i,mode){K.group.feature[mode]={},K.map.type[mode]={}})},K.modes.create(),$.each(K.group.feature,function(i,m){$.each(K.map.group,function(g,a){m[g]=new L.FeatureGroup})}),K.myMap.createPane("messagePane",L.DomUtil.get("message")),K.myMap.createPane("mapPane"),K.myMap.createPane("zonePane"),K.group.mode=K.group.feature[K.mode],K.tool.marker={full:!1,layers:{},fill:function(){let _this=K.tool.marker;!_this.full&&$.each(K.modes.get,function(i,mode){_this.layers[mode]={}}),_this.full=!0},enabled:function(){return!!$("#marker-tools").length},show:function(){let skip="boolean"==$.type(arguments[0])&&arguments[0];K.tool.marker._show.call(K.tool.marker,skip)},_show:function(skip){if(this.enabled()){if(skip)return;$("#marker-tools").remove()}else $("body").append('<div id="marker-tools" class="marker-panel"></div>'),tools=$("#marker-tools"),tools.append('<div class="outer inputs">\n                <div class="switch">\n                    <input name="switch" id="_2" type="radio" name="radio" value="underground">\n                    <label for="_2" class="label down" title="Underground">Below</label>\n                    <input name="switch" id="_1" type="radio" name="radio" value="" checked>\n                    <label for="_1" class="label level" title="Ground Level">Ground</label>\n                    <input name="switch" id="_3" type="radio" name="radio" value="overground">\n                    <label for="_3" class="label up" title="Overground">Above</label>\n                    <div class="indicator"></div>\n                </div>\n\t\t\t</div>\n            <div class="outer scroller">\n                <div class="icons"></div>\n            </div>'),tools.draggable({containment:"#mapid",start:function(){$(this).css({transform:"translateX(0)",bottom:"initial"})},stop:function(){this.position=$.extend({},$(this).position(),{transform:"translateX(0)",bottom:"initial",width:$(this).width(),height:$(this).height()}),K.local("toolPos",this.position)}}),this.position=K.local("toolPos")||!1,this.position&&(delete this.position.width,delete this.position.height,tools.css(this.position)),$(".switch input",tools).on("change",function(){$("a",tools).removeClass("underground overground").addClass($(this).val())}),$.each(sortObjByKeys(this.layers[K.mode]),function(category,layers){$('<span class="category"/>').text(category).appendTo(".outer .icons"),$.each(sortObjByKeys(layers),function(i,layer){let p=layer.o,active=p.type==(K.local("markerToolIcon")||"Contaminated")?"enabled":"",key=!1;$.each(K.shortcuts.QuickMarker,function(k,t){p.type!=t||"Underground"==p.type||(key=k)}),K.mode in p.mode&&$("<a />",{class:active,title:category+"<br>"+p.type.replace("Survival","").space(),category:category,type:p.type,html:`<img src="${p.iconUrl}">${key?'<span class="key">'+key+"</span>":""}`}).data("properties",p).appendTo(".outer .icons")})}),$("#marker-tools a").on("click",function(){let typ=$(this).attr("type");$(this).siblings("a").removeClass("enabled"),$(this).addClass("enabled"),K.local("markerToolIcon",typ);let o=$(this).data("properties");K.updateMarker($.extend(!0,{},o,{className:o.className.add($(".outer.inputs input:checked").val())})),K.bar.draw.Marker.enable()})}},K.tool.layer={join:!1,layer:{},new:{},element:null,shape:!1,modeSwitch:!1,setting:null,isPopup:!1,isOpen:function(){return!!$("#settings-menu").length},show:function(){K.tool.layer._show.call(K.tool.layer,this)},_show:function(layer){console.log(`Editing layer with ID: ${layer.options.id}`,layer);let self=this;if(K.check.deleting||K.check.editing||!K.bar.b.power.enabled())return this;if(this.tags||(this.tags=[],$.each(K.icons,function(v,i){self.tags.push(v)}),this.tags.sort()),this._hide(),this.layer=layer,this.shape=K.settingShape(layer.options.shape),K.in("saved",layer.editing)||(layer.editing.saved=!0),layer.makeBackup(),this.join){this.join._latlngs.push(layer._latlngs[0]),this.new=L.polygon(this.join._latlngs,$.extend({},this.join.options,{pane:"poly-hover"==this.join.options.className?"zonePane":"overlayPane"}));let p=this.join.popup;return(p.content||p.list)&&this.new.bindPopup(p),K.group.removeLayer(this.join),K.group.removeLayer(layer),K.group.addLayer(this.new),this.new.on("click",K.tool.layer.show),this.new.options.complete&&"marker"===this.new.options.shape&&this.new.on("contextmenu",function(){this.toggleCompleted(!0)}),this.new.saved(!1),this.new.storeSettings(),this.join=!1,K.msg.hide(),this}if($(layer["marker"!=layer.options.shape?"_path":"_icon"]).addClass("leaflet-layer-editing"),$("body").append('<div id="settings-menu" class="settings-divider">\n            <div class="settings-side left"></div>\n            <div class="settings-side right"></div>\n        </div>'),$("#settings-menu").on("remove",function(){$(".leaflet-layer-editing").removeClass("leaflet-layer-editing")}).draggable({containment:"#mapid",start:function(){$(this).css({transform:"translate(0, 0)"})},stop:function(){this.position=$.extend({},$(this).position(),{transform:"translate(0, 0)"}),K.local("menuPos",this.position)},handle:".settings-title"}),this.position=K.local("menuPos")||!1,this.position){let w=$(window).width()-300,h=$(window).height()-515;this.position.left=w<this.position.left?w:this.position.left,this.position.top=h<this.position.top?h:this.position.top,$("#settings-menu").css(this.position)}$(".settings-side.left").append(`<div class="settings-tools marker">\n\t\t\t    <span class="settings-title">${layer.options.shape.toUpperCase()}</span>\n\t\t\t</div>\n\t\t\t<div class="settings-tools popup">\n\t\t\t    <span class="settings-title">POPUP</span>\n\t\t\t</div>\n\t\t\t<div class="settings-tools buttons"></div>\n\t\t\t<div class="settings-tools save">\n                \x3c!-- <a class="settings-save button" aria-label="save">CONFIRM</a> --\x3e\n                <a class="settings-cancel button" aria-label="cancel">CANCEL</a>\n\t\t\t</div>\n\t\t\t<div class="creator">${layer.options.creator}</div>\n            <div class="unsaved" ${layer.editing.saved?'style="display: none"':""}>Save me!</div>`);let btn=$('<a class="settings icon button" />'),box=".settings-tools.buttons",btns=[{cls:"copy",title:"Copy these settings"},{cls:"paste",title:"Paste copied settings"},{cls:"edit"+(layer.editing.edit?" end":""),title:"Add this to editable layer"},{cls:"move"+(layer.dragging.enabled()?" end":""),title:"Drag this layer"},{cls:"join",title:"Make another polygon a hole in this",type:["polygon"]},{cls:"split",title:"Split these polygons",type:["polygon"]},{cls:"dupe",title:"Duplicate this poly",type:["polygon"]},{cls:"delete",title:"Delete this layer"},{cls:"to-type",title:"Copy selected setting to all of Type"}];for(i in btns)b=btns[i],!b.cls||b.type&&!K.has(this.shape,b.type)||btn.clone().attr({"aria-label":b.cls,title:b.title}).addClass(b.cls).appendTo(box);this.updateSaved();let shape=layer.options.shape;$.each(K.settings.main,function(i,n){K.has(shape,n.for)&&$("<a />",{class:"dnt settings-item button "+i,setting:i,html:i.firstToUpper().space()}).appendTo(".settings-tools.marker")}),$.each(K.settings.popup,function(i,n){$("<a />",{class:"dnt settings-item button "+i,setting:i,popup:!0,html:i.firstToUpper().space()}).appendTo(".settings-tools.popup")}),$(".settings-item").on("click",function(){self.element=$(this),self.setting=$(this).attr("setting"),self.isPopup=$(this).attr("popup"),self._settingClick()}),$(".settings-cancel").on("click",function(){self._cancel()}),$(".settings.copy").on("click",function(){layer.copy()}),$(".settings.paste").on("click",function(){self._paste()}).on("mouseover",function(){self._pasteOver(layer)}).on("mouseout",function(){self._pasteOut(layer)}),$(".settings.delete").on("click",function(){self._delete()}),$(".settings.dupe").on("click",function(){self._dupe()}),$(".settings.join").on("click",function(){self._join()}),$(".settings.to-type").on("click",function(){self._toType()}),$(".settings.move").on("click",this._move),$(".settings.edit").on("click",this._edit),K.in("_latlngs",layer)&&1==layer._latlngs.length?$(".settings.split").hide():$(".settings.split").on("click",function(){self._split()}),layer.editing.window&&$(`[aria-label="${layer.editing.window}"]`).trigger("mousedown"),$('.settings.icon[title!=""]').qtip({position:{viewport:$("#mapid"),my:"bottom left",at:"top center"},style:{classes:"tooltip-style"},show:{delay:250,solo:!0},hide:{event:"click mouseleave"},events:{hide:function(e,api){api.destroy(!0)}}});let div=L.DomUtil.get("settings-menu");return L.DomEvent.disableClickPropagation(div),L.DomEvent.on(div,"mousewheel",L.DomEvent.stopPropagation),this},_settingClick:function(){let self=this,layer=this.layer,setting=this.setting,isPopup=this.isPopup,object=K.settings[isPopup?"popup":"main"],values=[],box,toggle,input,editor;if(!setting)return;layer.editing.window=setting,K.in("values",object[setting])&&(values=sortObjByKeys(object[setting].values));let value=layer.options[setting];isPopup&&(value=layer.popup?layer.popup[setting]:""),$(".settings-side.right").html(`<div class="settings-tools right-bar" aria-label="${setting}">\n\t\t\t    <span class="settings-title">${isPopup?"POPUP ":""}${setting.space().toUpperCase()}</span>\n            </div>`),K.has(setting,["id"])||($(".right .settings-title").after(`<a class="settings icon copy inline" title="Copy this setting" \n                setting="${setting}" which="${isPopup?"popup":"icon"}"></a>`),$(".right .settings-title").after(`<a class="settings icon paste inline" title="Paste this setting" \n                setting="${setting}" which="${isPopup?"popup":"icon"}"></a>`),$(".settings.copy.inline").on("click",function(){self._copySingle()}),$(".settings.paste.inline").on("click",function(){self._pasteSingle()}));let bx=$(".settings-tools.right-bar");if(bx.parent().removeClass("code"),K.length(layer.options.mode)>1&&!K.has(setting,["mode","id","category","type","complete","time","link","group"])){const mode=layer.getMode(isPopup);let changes=!1;K.in(setting,mode)&&(changes=!0),changes&&(value=layer.getModeSetting(setting,isPopup));const mC=$("<div />",{class:"mode-container edit"}),desc=$("<span />",{class:"name",html:"Modify for mode:"}),msgs=["This will modify this setting for the original layer, no changes will be made to any modified modes.",`This will modify this setting for ${K.mode} only, no changes will be made to the original layer.\nSwitching this with changes already made will delete any changes for ${K.mode}.`],help=$("<span />",{class:"help",html:msgs[+changes]});toggle=$('<label class="switch">\n                <span class="label"></span>\n                <span class="back"></span>\n                <input type="checkbox" class="settings-item mode-switch check">\n                <span class="slider"></span>\n            </label>'),bx.append(mC.append(desc).append(toggle).append(help)),$("input",toggle).prop("checked",changes).on("change",function(){changes=$(this).is(":checked"),help.text(msgs[+changes]),changes||(K.in(setting,mode)&&delete mode[setting],self.modeSwitch=!0,self._settingClick(),apply()),setContentHeight()})}object[setting].description&&bx.append(`<span class="help">${object[setting].description}</span>`);const setContentHeight=function(){const right=$(".settings-side .right-bar");let adjust,height=0,max=8;$(".settings-side.left .settings-tools:not(.buttons)").each(function(){max+=$(this).outerHeight()}),$("> div:not(.scroll-box):not(.CodeMirror-wrap):visible, > span, > input",right).each(function(){height+=$(this).outerHeight()}),(adjust=$(".scroll-box",right)).length?adjust.css("max-height",max-height+"px"):(adjust=$(".CodeMirror-wrap",right)).length?adjust.css("height",max-height+"px"):(adjust=$("textarea",right)).length&&adjust.css("height",max-height+"px")},resetList=function(){$(".right-bar .list-box").remove(),$(".settings-tools.right-bar").append('<div class="scroll-box list-box">\n\t\t\t\t    <div class="section title">\n                        <span class="header">TITLE</span><br>\n                        <input type="text" class="settings-item input list" name="list-title" role="input" setting="list-title" which="popup" placeholder="Title">\n                    </div>\n                    <div class="section subs">\n                        <a class="add subs button" title="Add another paragraph">+</a>\n                        <span class="header">PARAGRAPH</span>\n                        <br>\n                    </div>\n                    <div class="section list">\n                        <a class="add list button" title="Add another item">+</a>\n                        <span class="header">LIST</span>\n                        <br>\n                    </div>\n\t\t\t\t</div>'),box=$("<div />",{class:"setting-container clone",num:0}),input=$("<input />",{type:"text",class:"settings-item input list",which:"popup"}),toggle=$('<label class="switch">\n                <span class="label"></span>\n                <span class="back"></span>\n                <input type="checkbox" class="settings-item input list check">\n                <span class="slider"></span>\n            </label>');let bx=box.clone().addClass("subs").appendTo(".section.subs"),tg;input.clone().attr({name:"list-sub",num:0,placeholder:"Paragraph"}).appendTo(bx),$("<br>").appendTo(bx),(tg=toggle.clone().appendTo(bx)).find("input").attr({name:"list-sub-class",cat:"color",num:0}),tg.find(".label").text("Color:"),(tg=toggle.clone().appendTo(bx)).find("input").attr({name:"list-sub-class",cat:"line",num:0}),tg.find(".label").text("Line:"),tg.find(".slider").addClass("note"),(tg=toggle.clone().appendTo(bx)).find("input").attr({name:"list-sub-class",cat:"note",num:0}),tg.find(".label").text("Note:"),tg.find(".slider").addClass("note"),bx=box.clone().addClass("list").appendTo(".section.list"),input.clone().attr({name:"list-item",num:0,placeholder:"Item",autocomplete:!0}).autocomplete({source:self.tags,autoFocus:!0,appendTo:"#settings-menu"}).appendTo(bx),input.clone().attr({type:"number",min:1,name:"list-qty",num:0,placeholder:"Qty"}).appendTo(bx)},cloneList=function(identifier){const clone=$(identifier).clone(),i=+clone.attr("num")+1;return clone.attr("num",i),$("input",clone).each(function(){$(this).attr("num",i),"checkbox"==$(this).attr("type")?$(this).prop("checked",!1):$(this).val(""),$(this).attr("autocomplete")&&$(this).autocomplete({source:self.tags,autoFocus:!0,appendTo:"#settings-menu"})}),$(identifier).removeClass("clone").parent().append(clone),clone},populateList=function(value){K.empty(value)||(value.title&&$("[setting=list-title]").val(value.title),K.empty(value.subs)&&(value.subs=[]),$.each(value.subs,function(i,itm){const tag=".subs.clone";let clone=$(tag);i&&(clone=cloneList(tag)),$("input[name=list-sub]",clone).val(itm.value),$("input[cat=color]",clone).prop("checked",itm.color),$("input[cat=note]",clone).prop("checked",itm.note),$("input[cat=line]",clone).prop("checked",itm.line)}),K.empty(value.list)&&(value.list=[]),$.each(value.list,function(i,itm){const tag=".list.clone";let clone=$(tag);i&&(clone=cloneList(tag)),$("input[name=list-item]",clone).val(itm.item),$("input[name=list-qty]",clone).val(itm.qty)}))};if(K.user.type>3&&!K.in(setting,["id"])){$(".settings-tools.right-bar").append('<div class="restore-container hide">\n                    <div class="restore-back img"></div>\n                    <span class="restore-text">Current</span>\n                    <div class="restore-forward img"></div>\n                </div>');const rc=$(".restore-container"),rb=$(".restore-back",rc),rf=$(".restore-forward",rc),rt=$(".restore-text",rc);let num,items;$.ajax({type:"POST",url:"includes/get_restore.php",data:{id:layer.options.id,setting:setting,type:isPopup?"p":"o"}}).done(function(data){items=$.parseJSON(data),$.each(items,function(key,val){K.equals(val,value)&&delete items[key]}),K.empty(items)||(rc.removeClass("hide"),rb.addClass("enabled"),items.Current=value,num=K.length(items)-1,setContentHeight())}),rc.on("click",".enabled",function(){const key=Object.keys(items)[$(this).hasClass("restore-back")?--num:++num],item=items[key];0==num?(rb.removeClass("enabled"),rf.addClass("enabled")):num==K.length(items)?(rf.removeClass("enabled"),rb.addClass("enabled")):(rf.addClass("enabled"),rb.addClass("enabled")),rt.text(key),"list"==setting?(resetList(),populateList(item),inputRenew(),apply.call($("[name=list-title]"))):"mode"==setting?(layer.applySetting({setting:"mode",value:"object"!=$.type(item)?{}:item}),$(".mode-container .input.mode").each(function(){const mode=$(this).attr("mode");$(this).prop("checked",K.has(mode,layer.options.mode));const cont=$(this).parents(".mode-container");cont.removeClass("changes"),!K.empty(layer.options.mode[mode])&&cont.addClass("changes")})):"link"==setting?($(".setting-container.links").each(function(){0==$("input",this).attr("num")?$("input",this).val(""):$(this).remove()}),"array"==$.type(item)&&$.each(item,function(i,v){i&&$(".add.links").trigger("click"),$(`input[num=${i}]`).val(v)})):K.length(values)?$(`[aria-label="${item}"]`).trigger("click"):(apply.call($("textarea.input").text(item)),editor&&editor.setValue(item))})}if("list"===setting)resetList(),"object"!=$.type(value)&&(layer.popup.list={},value={}),populateList(value),$(".settings-side.right").off("click",".list-box a.add").on("click",".list-box a.add",function(){let focus=!1,name=$(this).hasClass("subs")?".subs.clone":".list.clone";cloneList(name),$(` ${name.replace(".clone","")} input[type=text]`).each(function(){$(this).val()||focus||($(this).focus(),focus=!0)}),inputRenew()});else if("link"===setting){$(".settings-tools.right-bar").append('<div class="scroll-box">\n                    <div class="section links">\n                        <a class="add links button" title="Add another paragraph">+</a>\n                        <span class="header">LINKED IDS</span><br>\n                    </div>\n\t\t\t\t</div>'),value||(value=[""]),box=$("<div />",{class:"setting-container links"}),input=$("<input />",{name:"list-link",type:"text",class:"settings-item input link",placeholder:"Layer ID"});let grab=$("<a />",{class:"settings-item link grab"}),trash=$("<a />",{class:"settings-item link trash"});$.each(value,function(i,v){let bx=box.clone().appendTo(".section.links");input.clone().attr({value:v,num:i}).appendTo(bx),grab.clone().attr({num:i}).appendTo(bx),trash.clone().attr({num:i}).appendTo(bx)}),$("a.add").on("click",function(){let focus=!1,name='input[name="list-link"]',i=$(name).length,bx=box.clone().appendTo(".section.links");input.clone().attr({num:i}).appendTo(bx),grab.clone().attr({num:i}).appendTo(bx),trash.clone().attr({num:i}).appendTo(bx),$(name).each(function(i,el){$(el).val()||focus||($(el).focus(),focus=!0)}),inputRenew()}),$(".section.links").on("click",".trash",function(){1==$(".section.links input").length?$(".section.links input").val(""):($(`.section.links [num=${$(this).attr("num")}]`).parent().remove(),$(".setting-container").each(function(i){$("[num]",this).attr("num",i)})),apply.call(this)}),$(".section.links").on("click",".grab",function(){K.check.grabbing=!0;let i=$(this).attr("num"),layers=K.group.feature[K.mode].everyLayer,_this=this;layers.eachLayer(function(l){l.off("click"),l.on("click",function(){$(`.section.links .input[num=${i}]`).val(this.options.id),apply.call(_this),K.check.grabbing=!1,layers.eachLayer(function(l){l.off("click"),K.user.type&&(K.user.type>=4||l.options.creator.toLowerCase()==K.user.name.toLowerCase())&&l.on("click",K.tool.layer.show)})}),K.msg.show({msg:"Select the layer you would like to link to this.",time:2e3})})})}else if("mode"===setting){const mC=$("<div />",{class:"mode-container"}),desc=$("<span />",{class:"name"});toggle=$('<label class="switch">\n                <span class="label"></span>\n                <span class="back"></span>\n                <input type="checkbox" class="settings-item input mode check">\n                <span class="slider"></span>\n            </label>'),$.each(K.modes.get,function(i,mode){const cont=mC.clone().appendTo(bx);desc.clone().text(mode).appendTo(cont);const tg=toggle.clone().appendTo(cont);$("input",tg).prop("checked",K.has(mode,layer.options.mode)).attr("mode",mode),K.has(mode,layer.options.mode)&&!K.empty(layer.options.mode[mode])&&cont.addClass("changes")})}else if(K.length(values)){"className"!==setting||isPopup||(value=K.stripClasses(value)),bx.append(`<input type="text" class="settings-item input ${setting}" name="${setting}" \n                role="input" value="${value||""}" setting="${setting}" which="${isPopup?"popup":"icon"}">`);let img,col,num=1,retHtml='<div class="scroll-box">',colors=[];$.each(values,function(i,z){if("type"==setting&&!K.has(K.settingShape(layer.options.shape),z.shape))return;if(img="string"==$.type(i)&&i.contains(".svg"),col="string"==$.type(i)&&i.contains("#"))return colors.push(i),!0;let fst='<div class="settings-icons">',lst="</div>",trd=lst+fst;retHtml+=`${img&&1==num?fst:""}\n                    <a class="settings-item button selector${col?" color":img?" icon":""}" aria-label="${i}" role="button"\n                        ${value==i?` style="background-color: #2f474e; ${col?` color: ${i};`:""}"`:col?` style="color: ${i};"`:""}>\n                        ${img?`<img src="${i}" height="30" width="30">`:i} \n                    </a>\n                    ${img&&num==values.length?lst:img&&num%3==0?trd:""}`,num++}),retHtml=$(retHtml+"</div>"),img&&retHtml.addClass("has-icons"),bx.append(retHtml),$.unique(colors),colors.sort(),col&&new Huebee($(".settings-item.input")[0],{notation:"hex",hues:16,shades:8,saturations:5,customColors:colors,staticOpen:!0}).on("change",function(){$(".settings-item.input").trigger("change")})}else bx.append(`<textarea type="text" rows=2 cols=20 wrap="hard" class="settings-item input ${setting}" name="${setting}" setting="${setting}" which="${isPopup?"popup":"icon"}"${"id"==setting?" readonly":""}>${value||""}</textarea>`),K.in(setting,["html","content"])&&(bx.parent().addClass("code"),(editor=CodeMirror.fromTextArea($(`textarea.${setting}`)[0],{lineNumbers:!0,mode:"htmlmixed",indentUnit:4,theme:"one-dark",indentWithTabs:!0,showCursorWhenSelecting:!0,autoCloseBrackets:!0,autoCloseTags:!0,lineWrapping:!0})).on("change",function(){$("textarea.input").text(editor.getValue()).trigger("input")}));const apply=function(){const $input=$(".settings-item.input"),$mode=$(".mode-switch"),o={setting:$input.attr("setting"),value:$input.val(),forMode:$mode.length&&$mode.is(":checked")};if($(this).hasClass("list"))o.setting="list",o.value={},o.value.title=$('.input[name="list-title"]').val(),o.value.subs=[],$('.input[name="list-sub"]').each(function(){let t=$(this).val();if(!t)return!0;let p=$(this).parent(),c=p.find("[cat=color]").is(":checked"),l=p.find("[cat=line]").is(":checked"),n=p.find("[cat=note]").is(":checked"),r={value:t};c&&(r.color=c),l&&(r.line=l),n&&(r.note=n),o.value.subs.push(r)}),o.value.list=[],$('.input[name="list-item"]').each(function(){let no=$(this).attr("num"),t=$(this).val();if(!t)return!0;o.value.list.push({item:t,qty:$(`.input[name="list-qty"][num="${no}"]`).val()||1})}),removeEmpty(o.value);else if($(this).hasClass("link"))o.setting="link",o.value=[],$("[name=list-link]").each(function(i,el){let v=$(this).val();v&&o.value.push(v)}),removeEmpty(o.value);else if($(this).hasClass("mode"))o.setting="mode",o.value=layer.backup.options.mode||layer.options.mode||{},$("input",bx).each(function(){const mode=$(this).attr("mode");$(this).is(":checked")?mode in o.value||(o.value[mode]={}):delete o.value[mode]});else if("className"==o.setting&&!isPopup){let color=K.in("popup",layer)&&K.in("className",layer.popup)?layer.popup.className:"";o.value+=` ${layer.options.group} ${color}`}isPopup&&layer.updatePopup(o),!isPopup&&layer.applySetting(o)};$(".settings-item.selector").on("click",function(){let $input=$(".settings-item.input");if($(this).hasClass("color")){let hex=$(this).attr("aria-label");$input.css({"background-color":hex,color:textColor(hex)})}$(".settings-side.right a:not(.settings-apply)").css("background-color","#24373d"),$(this).css("background-color","#2f474e"),$input.val($(this).attr("aria-label")),apply.call(this)});const inputRenew=function(){$(".input").each(function(){if($(this).prop("readonly"))return;let el=$(this),binds={text:"propertychange change focus input paste",number:"propertychange change focus input paste",checkbox:"change"},type=$(this).attr("type");el.data("oldVal",el.val()),el.unbind(binds[type]),el.bind(binds[type],function(e){let check=$(this).hasClass("check");if(!check&&el.data("oldVal")==el.val())return;!check&&el.data("oldVal",el.val());let title=$('input[name="list-title"]');if(title.removeClass("incorrect"),title.val()||title.addClass("incorrect"),check){let input=$(this).parent("label").prev("input");input.removeClass("gray"),$(this).is(":checked")&&input.addClass("gray")}apply.call(this)})})};return inputRenew(),setContentHeight(),$('.inline.icon[title!=""]').qtip({position:{viewport:$("#mapid"),my:"right center",at:"left center"},style:{classes:"tooltip-style"},show:{delay:250,solo:!0},hide:{event:"click mouseleave"},events:{hide:function(e,api){api.destroy(!0)}}}),this.modeSwitch&&apply(),this.modeSwitch=!1,this},_save:function(){this._hide(),layer.copy(),delete layer.backup,K.in(K.mode,layer.options.mode)||K.group.removeLayer(layer)},_cancel:function(){this._hide();let layer=this.layer,o=layer.options,b=layer.backup;$.extend(!0,o,b.options),b.popup&&(layer.unbindPopup(),layer.bindPopup(b.popup)),"marker"==o.shape?(layer.setLatLng(b.pos.latlng),layer.updateIcon()):K.has(o.shape,["polyline","polygon"])?(layer.setLatLngs(b.pos.latlngs),layer.setStyle(o)):"circle"==o.shape&&(layer.setLatLng(b.pos.latlng),layer.setRadius(b.pos.radius)),K.complete.is(layer)&&K.complete.add(layer),layer.storeSettings(),layer.saved(!0)},_copySingle:function(){const copy=K.local("copySingle")||{},layer=this.layer,isPopup=this.isPopup,setting=this.setting,value=layer[isPopup?"popup":"options"][setting];if(K.empty(value))return K.msg.show({msg:"Copy failed!",time:2e3}),this;const t=isPopup?"p":"o";return K.in(t,copy)||(copy[t]={}),copy[t][setting]=value,K.local("copySingle",copy),K.msg.show({msg:"Setting copied!",time:2e3}),this},_paste:function(){let layer=this.layer,copy,options=(K.local("copy")||{})[K.settingShape(layer.options.shape)]||!1;options?($.each(options.o,function(setting,value){layer.applySetting({setting:setting,value:value})}),$.each(options.p,function(setting,value){layer.updatePopup({setting:setting,value:value})}),K.msg.show({msg:"Settings pasted!",time:2e3}),this._settingClick()):K.msg.show({msg:"You need to copy something first!",time:2e3})},_pasteSingle:function(){const copy=K.local("copySingle")||{},layer=this.layer,isPopup=this.isPopup,ms=$(".mode-switch"),t=isPopup?"p":"o",o={setting:this.setting,forMode:!!ms.length&&ms.is(":checked")};K.in(t,copy)&&K.in(setting,copy[t])?(o.value=copy[t][setting],isPopup&&layer.updatePopup(o),!isPopup&&layer.applySetting(o),this._settingClick()):K.msg.show({msg:"There is no copied setting!",time:2e3})},_pasteOver:function(){let c,layer=this.layer,s=K.settingShape(layer.options.shape);"marker"!=layer.options.shape&&layer.makeBackup().setStyle($.extend(layer.options,c=K.local("copy")&&K.in(s,c)&&c[s]||{}))},_pasteOut:function(){const layer=this.layer;"marker"!=layer.options.shape&&layer.setStyle($.extend(layer.options,layer.paste.options))},_delete:function(){let _this=this;this._hide(),$("<div />",{class:"screen-blank",html:$("<div />",{class:"confirm",html:$("<div />",{class:"message",html:"Are you sure you want to delete this layer?"})})}).appendTo("body"),$("<a />",{class:"button no",title:"Cancel",html:"Cancel"}).appendTo(".confirm").on("click",function(){$(".screen-blank").remove()}),$("<a />",{class:"button yes",title:"Delete",html:"Delete"}).appendTo(".confirm").on("click",function(){_this._trueDelete.call(_this),$(".screen-blank").remove()})},_trueDelete:function(){this.layer.delete()},_toType:function(){const layer=this.layer,isPopup=this.isPopup,setting=this.setting;if(!setting||!layer.options.type||"type"==setting)return;const $mode=$(".mode-switch"),o={setting:setting,value:K.getSetting(layer[isPopup?"popup":"options"],setting),forMode:$mode.length&&$mode.is(":checked")},g=K.layer[layer.options.type],t=isPopup?"p":"o";g.changed=!0,!K.in(t,g)&&(g[t]={}),o.forMode?(!K.in("mode",g[t])&&(g[t].mode={[K.mode]:{}}),!K.in(t,g[t].mode[K.mode])&&(g[t].mode[K.mode][t]={}),g[t].mode[K.mode][t][setting]=o.value):g[t][setting]=o.value,$.each(K.group.mode,function(i,g){$.each(g._layers,function(i,l){l.options.type==layer.options.type&&(isPopup?l.updatePopup(o):l.applySetting(o))})}),K.msg.show({msg:"Setting copied to all "+layer.options.type.space(),time:2e3})},_dupe:function(){this._hide();let layer=this.layer,set=$.extend({},layer.options,{id:ID()}),ll=layer._latlngs,pType=polyType(ll);"circle"==layer.shape?((ll=layer._latlng).lng-=1e-6,ll.lng-=1e-6):K.has(pType,["polygon","polyline"])?("polygon"==pType&&(ll=ll[0]),ll.splice(1,0,L.latLng((ll[0].lat+ll[1].lat)/2,(ll[0].lng+ll[1].lng)/2))):(ll[0][0].lng-=1e-6,ll[0][1].lng-=1e-6),this.new="circle"==layer.shape?L.circle(layer._latlng,$.extend(set,{radius:layer._mRadius})):L[pType](layer._latlngs,set),K.group.addLayer(this.new),this.new.on("click",this.show),this.new.saved(!1),switchLayerGroups(),polyHoverAnimation(),K.msg.show({msg:"Duplicated",time:2e3})},_join:function(){let layer=this.layer;this.join=layer,layer.off("click").bringToBack(),this._hide(),K.msg.show({msg:"Select the shape to join!",time:3e3})},_move:function(){let fn,layer=K.tool.layer.layer;layer.dragging.enabled()?(layer.dragging.disable(),$(this).removeClass("end")):(layer.dragging.enable(),$(this).addClass("end"),layer.on("dragend",function(){this.saved(!1)}))},_edit:function(){let fn,layer=K.tool.layer.layer;layer.editing.edit=!layer.editing.edit,$(this).toggleClass("end"),switchLayerGroups()},_split:function(){this._hide();let layer=this.layer,newLayer,show=this.show;$.each(layer._latlngs,function(i,m){sets=$.extend({},layer.options,{id:ID()}),newLayer=L[polyType([m])]([m],sets),K.group.addLayer(newLayer),newLayer.on("click",show),newLayer.saved(!1)}),K.group.removeLayer(layer),switchLayerGroups(),polyHoverAnimation()},_hide:function(){$("#settings-menu").remove()},_refresh:function(){K.tool.layer._hide(),K.tool.layer._show.call(K.tool.layer,K.tool.layer.layer)},updateSaved:function(){!this.layer.editing.saved||this.layer.backup&&this.layer.backup.changes?($(".settings-save").css("background-color","#735711"),$(".unsaved").show()):($(".settings-save").css("background-color","#24373d"),$(".unsaved").hide())}},L.Layer.include({tools:K.tool.layer,backup:!1,makeBackup:function(){let t=this.backup?"paste":"backup";return this.oldType=this.options.type,this[t]={},this[t].options=K.reduce({},this.options,K.map.property[this.options.shape]),this.popup&&(this[t].popup=K.extend({},this.popup)),"backup"==t&&(K.has(this.options.shape,["polygon","polyline"])?this.backup.pos={latlngs:L.LatLngUtil.cloneLatLngs(this.getLatLngs())}:"marker"==this.options.shape?this.backup.pos={latlng:L.LatLngUtil.cloneLatLng(this.getLatLng())}:"circle"==this.options.shape&&(this.backup.pos={latlng:L.LatLngUtil.cloneLatLng(this.getLatLng()),radius:this._mRadius})),this},applySetting:function(options){const o=$.extend({setting:void 0,value:void 0,skipSave:!1,forMode:!1},options),group=this.options.group;this.backup||o.skipSave||this.makeBackup(),"type"==o.setting&&(this.oldType=this.options.type);let m=!!o.forMode&&this.getMode();const mSp=this.getModeSettingPath(o.setting);if(!o.forMode&&null!==mSp&&delete mSp[o.setting],"marker"==this.options.shape&&K.has(o.setting,["className","iconUrl","iconSize","html"])){let p=this.options;o.value="string"==$.type(o.value)&&o.value.bMatch(/\d+,\d+/)?o.value.split(","):o.value,!m&&(p[o.setting]=o.value),m&&(m[o.setting]=o.value),this.updateIcon(),K.complete.is(this)&&K.complete.add(this)}else m?m[o.setting]=o.value:this.options[o.setting]=o.value;"group"==o.setting&&switchLayerGroup(this,group),"marker"!=this.options.shape&&this.setStyle(this.options);const type=this.options.type,counts=K.map.type.counts;if(type!=this.oldType&&(type&&!K.in(type,counts)&&(counts[type]=0),type&&(counts[type]+=1),this.oldType&&(counts[this.oldType]-=1)),type!=this.oldType&&K.in(type,K.layer)){this.oldType=type;const _this=this;$.each(K.curtail({},K.layer[type].o,["type","shape"]),function(key,val){_this.applySetting({setting:key,value:val,forMode:o.forMode})}),K.layer[type].p&&$.each(K.layer[type].p,function(key,val){_this.updatePopup({setting:key,value:val,forMode:o.forMode})})}return K.empty(this.options.mode)&&(this.options.mode={[K.mode]:{}}),this.storeSettings(),!o.skipSave&&this.saved(!1),this},getMode:function(isPopup){const m=this.options.mode[K.mode],t=isPopup?"p":"o";return!K.in(t,m)&&(m[t]={}),m[t]},getModeSetting:function(setting,isPopup){const m=this.options.mode[K.mode],t=isPopup?"p":"o";return K.in(t,m)&&K.in(setting,m[t])?m[t][setting]:null},getModeSettingPath:function(setting,isPopup){const m=this.options.mode[K.mode],t=isPopup?"p":"o";return K.in(t,m)&&K.in(setting,m[t])?m[t]:null},getSetting:function(setting,isPopup){const o=(isPopup?this.popup:this.options)||{},modeValue=this.getModeSetting(setting,isPopup);return null!==modeValue?modeValue:o[setting]},updatePopup:function(options){const o=$.extend({setting:void 0,value:void 0,forMode:!1},options);this.backup||this.makeBackup();const mSp=this.getModeSettingPath(o.setting,!0);return!o.forMode&&null!==mSp&&delete mSp[o.setting],!this.popup&&(this.popup={}),!o.forMode&&(this.popup[o.setting]=o.value),o.forMode&&(this.getMode(!0)[o.setting]=o.value),this.unbindPopup(),this.hasPopupContent()&&this.bindPopup(this.popup),this.storeSettings(),this.saved(!1),this},hasPopupContent:function(){return!!this.popup&&(this.getSetting("content",!0)||!K.empty(this.getSetting("list",!0)))},storeSettings:function(){const counts=K.map.type.counts,type=this.options.type;if(1==counts[type]){!(type in K.layer)&&(K.layer[type]={});const m=K.layer[type],o=this.options;if("marker"==o.shape&&(o.iconUrl&&delete o.html,!o.iconUrl&&delete o.iconUrl),m.o=K.reduce({},o,K.map.property[this.options.shape]),K.in("link",m.o)&&delete m.o.link,m.changed=!0,this.popup){const p=this.popup;m.p={className:p.className},!K.empty(p.list)&&(m.p.list=p.list),!m.p.list&&(m.p.content=p.content)}0==counts[this.oldType]&&(delete K.layer[this.oldType],delete K.map.type.counts[this.oldType])}return this},saved:function(saved){let tool=K.tool.layer;return this.editing.saved=saved,this.backup.changes=!saved,saved?(K.save.remove(this),delete this.backup):K.save.add(this),tool.isOpen()&&tool.updateSaved(),this},delete:function(){K.save.delete(this)},copy:function(){let copy=K.local("copy")||{};return copy[K.settingShape(this.options.shape)]={o:K.reduce({},this.options,K.map.property[this.options.shape]),p:!!this.popup&&this.popup},K.local("copy",copy),K.msg.show({msg:"Settings copied!",time:2e3}),K.updateMarker(),this}}),$(function(){$.ajax({url:"includes/credits.php"}).done(function(a){K.credits=a}),K.tool.marker.fill(),$.ajax({url:"includes/map_date.php"}).done(function(a){K.mapVersion=a,L.imageOverlay(`images/map.svg?v=${K.mapVersion}`,[[15,-15],[-15,15]],{attribution:'<a title="Tom Clancy\'s The Division 2" href="https://tomclancy-thedivision.ubisoft.com/">The Division 2</a>',pane:"mapPane"}).addTo(K.myMap)}),K.myMap.addLayer(K.group.mode.groupAll),K.myMap.on("zoomend moveend",function(e){zoom=e.target._zoom,onZoomEnd(),K.local("zoom",K.myMap.getZoom()),K.local("pan",K.myMap.getCenter()),polyHoverAnimation()});const mC=$(".map-mode-box"),mB=$(".map-mode",mC).detach();$.each(K.modes.get,function(i,mode){const nB=mB.clone();$("img",nB).attr("src",`images\\mode-${mode.toLowerCase().replace(/ /g,"-")}.svg`),$("span",nB).text(mode),nB.attr("mode",mode),mC.append(nB),mode==K.mode&&nB.addClass("active")});const reorderModes=function(){const gap=45;let i=0;$(".map-mode").each(function(){$(this).hasClass("active")?$(this).css("top",0):(i++,$(this).css("top",45*i+"px"))})};reorderModes(),$(".map-mode").on("click",function(){mC.hasClass("active")?($(this).hasClass("active")||($(this).siblings().removeClass("active"),$(this).addClass("active"),reorderModes(),K.mode=$(this).attr("mode"),K.local("mode",K.mode),K.group.mode=K.group.feature[K.mode],!K.bar.b.power||K.bar.b.power.enabled()||(K.check.doOnce=!0),setTimeout(()=>{pageLoad()},1e3)),mC.removeClass("active")):mC.addClass("active")}),$("#side-bar .side-menu-toggle:not(.mode):not(.full)").on("click",function(){let sb=$("#side-bar"),c="active",a=$(this).attr("button"),o=K.local("sideMenu"),setCookies=function(){K.local("sideBar",sb.hasClass(c)),K.local("sideMenu",a)};$(this).hasClass(c)?(sb.removeClass(`${c} ${a}`),setTimeout(function(){sb.children().removeClass(c),setCookies()},1e3)):sb.hasClass(c)?(sb.removeClass(`${c} ${o}`),setTimeout(function(){sb.children().removeClass(c),sb.addClass(`${c} ${a}`),sb.children(`.${a}`).addClass(c),setCookies()},1e3)):(sb.addClass(`${c} ${a}`),sb.children(`.${a}`).addClass(c),setCookies())}),$("#side-bar > a").each(function(i,el){$(this).css("top",i=10+40*i+"px")});let el=$("#side-bar .side-menu-toggle.full");el.on("click",toggleFullScreen),$(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange",function(e){el.toggleClass("yes")}),K.urlParam("overwolf")||K.local("currentUpdate")==K.currentUpdate||(K.local("sideMenu","changes"),K.local("sideBar",!0),K.local("currentUpdate",K.currentUpdate)),$("#side-bar .login").on("click",".page",function(){let page=$(this).attr("name");$.ajax({url:`includes/${page}.php`}).done(function(a){a&&$("#side-bar .login .side-content").html(a)})}),$("#side-bar").on("click","#regform .button",doRegister),$("#side-bar").on("keypress","#regform .input",function(e){13==e.which&&doRegister()}),$("#side-bar").on("click","#donate.button",doDonator),$("#side-bar").on("keypress","#donator",function(e){13==e.which&&doDonator()}),$("#side-bar").on("click","#login .button",doLogin),$("#side-bar").on("keypress","#login .input",function(e){13==e.which&&doLogin()}),$("#side-bar").on("click","#reset .button",doReset),$("#side-bar").on("keypress","#reset .input",function(e){13==e.which&&doReset()}),$("#side-bar").on("click","#forgot .button",doForgot),$("#side-bar").on("keypress","#forgot .input",function(e){13==e.which&&doForgot()}),$("form").submit(function(){return!1}),$("#side-bar").on("click","#logout",function(){$.ajax({url:"includes/logout.php"}).done(function(a){K.user.name=!1,K.user.type=0,K.user.data=!1,$("#side-bar .login .side-content").html(a),pageLoad()})}),$("#side-bar").on("click","#rem-check",function(){$.ajax({type:"POST",url:"includes/validator.php",data:{checked:$(this).prop("checked")}})}),$(document).mousedown(function(e){if(K.check.grabbing)return;const container=$(".settings-divider, .switch-active-group, #slider-box, .group-switch");container.is(e.target)||0!==container.has(e.target).length||$(container).remove(),$(".map-mode-box").hasClass("active")&&!$(e.target).hasClass("map-mode")&&$(".map-mode-box").removeClass("active")}),$("#side-bar").on("focus",".login .input",function(){$("."+$(this).attr("name")).show(500)}).on("blur",".login .input",function(){$("."+$(this).attr("name")).hide(500)}).on("propertychange change click keyup input paste",".login .input",function(){let el=$(this),ty=el.attr("id"),vl=el.val(),re=!1;"email"==ty||"donator"==ty?re=vl.bMatch(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/):"username"==ty?re=vl.bMatch(/^\w+$/):"password"==ty?re=vl.bMatch(/(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}/):"confirmpwd"==ty&&(re=vl==$("#password").val()),el.addClass("incorrect"),re&&el.removeClass("incorrect")}),$("#side-bar .side-menu-toggle").on("mouseenter touchstart",function(){$(this).css("left","-"+($(this).width()+50)+"px")}).on("mouseleave touchmove click",function(){$(this).css("left","-35px")}),$(window).bind("beforeunload",function(){if(K.save.check()){if(navigator.userAgent.toLowerCase().match(/msie|chrome/)){if(window.aysHasPrompted)return;window.aysHasPrompted=!0,window.setTimeout(function(){window.aysHasPrompted=!1},900)}return"are you sure"}}),void 0!==K.local("powered")&&(K.check.doOnce=!K.local("powered")),"string"==$.type(K.urlParam("d"))&&$.ajax({type:"POST",url:"includes/process_donator.php",data:{load:K.urlParam("d")}}).done(function(a){window.location.href=window.location.href.split("?")[0]}),pageLoad()});let ID=function(){return"_"+Math.random().toString(36).substr(2,9)};function arraysEqual(a,b){if(a===b)return!0;if(null==a||null==b)return!1;if(a.length!=b.length)return!1;a.sort(),b.sort();for(let i=0;i<a.length;++i)if(a[i]!==b[i])return!1;return!0}let tagsToReplace={"&":"&amp;","<":"&lt;",">":"&gt;"};function replaceTag(tag){return tagsToReplace[tag]||tag}function safeTags(str){return str.replace(/[&<>]/g,replaceTag)}function hideAlert(){$("#alert").hide()}function naturalCompare(a,b){let ax=[],bx=[];for(a.replace(/(\d+)|(\D+)/g,function(_,$1,$2){ax.push([$1||1/0,$2||""])}),b.replace(/(\d+)|(\D+)/g,function(_,$1,$2){bx.push([$1||1/0,$2||""])});ax.length&&bx.length;){let an=ax.shift(),bn=bx.shift(),nn=an[0]-bn[0]||an[1].localeCompare(bn[1]);if(nn)return nn}return ax.length-bx.length}
//# sourceMappingURL=div.map.min.js.map
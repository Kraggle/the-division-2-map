import{jQuery as $}from"../jQuery/jquery3.4.1.js";import{L}from"../Leaflet/leaflet1.5.1.js";import{K}from"../K.js";export function randomInt(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e}export function empty(e){"boolean"!=K.type(e)&&(e.remove(),e=!1)}export function removeEmpty(e){let t="array"==K.type(e);return K.each(e,function(o,n){K.has(K.type(n),["object","array"])&&(e[o]=removeEmpty(n));let r=K.type(n);("string"==r&&!n||"object"==r&&!K.length(n)||"array"==r&&!n.length||"function"==r)&&(t?e.splice(o,1):delete e[o])}),e}export function sortObjByKeys(e){let t=Object.keys(e),o={};return t.sort(naturalCompare),K.each(t,function(t,n){o[n]=e[n]}),o}export function polyHoverAnimation(e){let t=$('path.leaflet-interactive:not(.poly-hover):not([fill="none"])');t.off("mouseover mouseout"),e||t.on("mouseover",function(){let e=$(this),t=e.attr("class").split(" ");K.each(t,function(t,o){o.contains("phg")&&(e=$("path."+o))}),e.addClass("hover")}).on("mouseout",function(){let e=$(this),t=e.attr("class").split(" ");K.each(t,function(t,o){o.contains("phg")&&(e=$("path."+o))}),e.removeClass("hover")})}export function editIconMessage(){let e,t=$(".leaflet-editing-icon"),o=$("#message");o.children(".message").length||o.append('<div class="message"></div>'),e=o.children(".message"),t.length>1e3&&e.text("There are "+t.length+" editing icons, \t\tyou may want to switch groups to speed things up!"),e.text(""),K.check.editing&&setTimeout(editIconMessage,2e3)}export function setGridRotate(e){let t=$(".leaflet-overlay-pane").children().last();if("images/grid.svg"!=t.attr("src"))return;let o=t.css("transform").split(",");K.grid.x=!K.grid.x||e?o[4]:K.grid.x,K.grid.y=!K.grid.y||e?o[5].replace(")",""):K.grid.y,K.grid.r=K.local("grid-rotate")||0;let n=K.local("grid-x-pos")||0,r=K.local("grid-y-pos")||0;Number(K.grid.x),Number(K.grid.y),Number(K.grid.r),Number(n),Number(r);let a=`translate3d(${K.grid.x*(n/1e5+1)}px, \n        ${K.grid.y*(r/1e5+1)}px, 0px) rotate(${K.grid.r}deg)`;t.css({transformOrigin:"center",transform:a})}export function toggleHideIcons(){$("#side-bar .side-bar-button:not(.inactive)").length?$("#side-bar .hide-all").removeClass("hidden"):$("#side-bar .hide-all").addClass("hidden"),$("#side-bar .filters .box-content .category-wrap").each(function(){const e=$(".side-bar-button",this);let t=0;e.each(function(){$(this).hasClass("inactive")&&t++}),$(".hide-some",this).removeClass("hidden"),t==e.length&&$(".hide-some",this).addClass("hidden")})}export function showHideAllLayers(e){K.each(K.map.type[K.mode],function(t,o){K.each(o,function(o){let n=$(`[set="${t}"][label="${o}"]`);n.removeClass("inactive"),e&&n.addClass("inactive"),K.filters=K.local("filters")||{},K.filters[o]=e,K.local("filters",K.filters),showHideLayers(t,o,e)})})}export function showHideCategory(e,t){K.each(K.map.type[K.mode][e],function(o){let n=$(`[set="${e}"][label="${o}"]`);n.removeClass("inactive"),t&&n.addClass("inactive"),K.filters=K.local("filters")||{},K.filters[o]=t,K.local("filters",K.filters),showHideLayers(e,o,t)})}export function showHideLayers(e,t,o){let n,r,a,i;switchLayerGroups(!0),K.each(K.map.group,function(l,s){K.has(t,s)&&(n=K.group.mode[l],r=o?K.group.mode.groupHidden:n,a=o?n:K.group.mode.groupHidden,i=o?"groupHidden":l,r&&a&&a.eachLayer(function(o){let n=o._leaflet_id;o.options.type==t&&o.options.category==e&&(r.addLayer(a.getLayer(n)),a.removeLayer(n),o.currentGroup=i)}))}),switchLayerGroups(),polyHoverAnimation()}export function toCorrectType(e,t){if(!K.settings.main[e])return t;const o=K.settings.main[e].type;return"number"==o?Number(t):"boolean"==o?"true"==t||"false"!=t&&!!t:("mode"==e&&K.each(t,function(e,o){K.empty(o)&&"array"==K.type(o)&&(t[e]={})}),t)}export function offset(e,t,o){return t&&(e.lat+=t),o&&(e.lng+=o),e}export function textColor(e){e=e.substring(1);let t=parseInt(e,16);return.2126*(t>>16&255)+.7152*(t>>8&255)+.0722*(t>>0&255)<40?"#ffffff":"#000000"}export function switchLayerGroup(e,t){const o=e.options.group;K.group.removeLayer(e),K.group.addLayer(e),$(e._icon).removeClass(t).addClass(o)}export function createPoint(e,t){return $.isArray(e)?L.point(e[0],e[1]):L.point(e,t)}export function switchLayerGroups(e){K.group.draw.eachLayer(function(e){K.group.fromDraw(e)}),!e&&K.each(K.group.all(),function(e,t){(K.map.active[t.options.type]&&(t.options.creator==K.user.name||K.user.type>3)||t.editing.edit)&&K.group.toDraw(t)}),K.myMap.removeLayer(K.group.draw).addLayer(K.group.draw).addLayer(K.group.mode.groupAll),K.myMap.panBy([0,0])}export function toggleFullScreen(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(Element.ALLOWKEYBOARD_INPUT)}export function fixNum(e){return Number(e)?Number(e):e}export function polyType(e){return 1==e.length&&4==e[0].length&&e[0][0].lat==e[0][3].lat&&e[0][0].lng==e[0][1].lng?"rectangle":e[0].lat?"polyline":"polygon"}export function getType(e,t,o){if(!K.has(o,["marker","polyline","polygon"]))return"";let n="";return e=e.replace("images/",""),K.each(K.map.type,function(t,r){K.each(r[o],function(t,o){K.has(e,o)&&(n=t)})}),n}export function getMode(e){let t="all";return K.each(K.map.mode,function(o,n){K.has(e,n)&&(t=o)}),t}export function setAllLayerClick(){K.group.feature[K.mode].everyLayer.eachLayer(function(e){e.off("click"),K.check.grabbing&&e.on("click",function(){return this.options.id})})}export function onZoomEnd(){setGridRotate(!0);const e=K.myMap.getZoom()+(K.touchOnly?1:0);let t="";for(let e=7;e<12;e++)t+=` z${e}`;$("#map-id").removeClass(t),$("#map-id").addClass(`z${Math.floor(e)}`),K.each(K.group.mode,function(t){let o=t.replace("group","");"number"==typeof(o=o.contains("_")?o.split("_"):o.bMatch(/\d+/)?Number(o):!K.has(o,["Hidden","Complete","everyLayer"])&&0)&&e>=o-1||"object"==typeof o&&e>=o[0]-1&&e<=o[1]+1?K.myMap.addLayer(K.group.mode[t]):K.myMap.removeLayer(K.group.mode[t])})}export function urlExists(e,t){$.ajax({type:"HEAD",url:e,success:function(){t(!0)},error:function(){t(!1)}})}export function setSelectionRange(e,t,o){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,o);else if(e.createTextRange){let n=e.createTextRange();n.collapse(!0),n.moveEnd("character",o),n.moveStart("character",t),n.select()}}export function setCaretToPos(e,t,o){setSelectionRange(e,t,o||t)}export let ID=function(){return"_"+Math.random().toString(36).substr(2,9)};export function arraysEqual(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;e.sort(),t.sort();for(let o=0;o<e.length;++o)if(e[o]!==t[o])return!1;return!0}let tagsToReplace={"&":"&amp;","<":"&lt;",">":"&gt;"};export function replaceTag(e){return tagsToReplace[e]||e}export function safeTags(e){return e.replace(/[&<>]/g,replaceTag)}export function hideAlert(){$("#alert").hide()}export function naturalCompare(e,t){let o=[],n=[];for(e.replace(/(\d+)|(\D+)/g,function(e,t,n){o.push([t||1/0,n||""])}),t.replace(/(\d+)|(\D+)/g,function(e,t,o){n.push([t||1/0,o||""])});o.length&&n.length;){let e=o.shift(),t=n.shift(),r=e[0]-t[0]||e[1].localeCompare(t[1]);if(r)return r}return o.length-n.length}class Timed{run(e,t){this.time=t,this.callback=e,this._action()}_action(){this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(this.callback,this.time)}}export function timed(){return new Timed}
//# sourceMappingURL=misc.min.js.map
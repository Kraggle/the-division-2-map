import{CodeMirror}from"../../lib/codemirror.js";var defaultTags={script:[["lang",/(javascript|babel)/i,"javascript"],["type",/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^module$|^$/i,"javascript"],["type",/./,"text/plain"],[null,null,"javascript"]],style:[["lang",/^css$/i,"css"],["type",/^(text\/)?(x-)?(stylesheet|css)$/i,"css"],["type",/./,"text/plain"],[null,null,"css"]]};function maybeBackup(t,e,a){var n=t.current(),r=n.search(e);return r>-1?t.backUp(n.length-r):n.match(/<\/?$/)&&(t.backUp(n.length),t.match(e,!1)||t.match(n)),a}var attrRegexpCache={};function getAttrRegexp(t){var e=attrRegexpCache[t];return e||(attrRegexpCache[t]=new RegExp("\\s+"+t+"\\s*=\\s*('|\")?([^'\"]+)('|\")?\\s*"))}function getAttrValue(t,e){var a=t.match(getAttrRegexp(e));return a?/^\s*(.*?)\s*$/.exec(a[2])[1]:""}function getTagRegexp(t,e){return new RegExp((e?"^":"")+"</s*"+t+"s*>","i")}function addTags(t,e){for(var a in t)for(var n=e[a]||(e[a]=[]),r=t[a],l=r.length-1;l>=0;l--)n.unshift(r[l])}function findMatchingMode(t,e){for(var a=0;a<t.length;a++){var n=t[a];if(!n[0]||n[1].test(getAttrValue(e,n[0])))return n[2]}}CodeMirror.defineMode("htmlmixed",function(t,e){var a=CodeMirror.getMode(t,{name:"xml",htmlMode:!0,multilineTagIndentFactor:e.multilineTagIndentFactor,multilineTagIndentPastTag:e.multilineTagIndentPastTag}),n={},r=e&&e.tags,l=e&&e.scriptTypes;if(addTags(defaultTags,n),r&&addTags(r,n),l)for(var o=l.length-1;o>=0;o--)n.script.unshift(["type",l[o].matches,l[o].mode]);function i(e,r){var l,o=a.token(e,r.htmlState),c=/\btag\b/.test(o);if(c&&!/[<>\s\/]/.test(e.current())&&(l=r.htmlState.tagName&&r.htmlState.tagName.toLowerCase())&&n.hasOwnProperty(l))r.inTag=l+" ";else if(r.inTag&&c&&/>$/.test(e.current())){var s=/^([\S]+) (.*)/.exec(r.inTag);r.inTag=null;var g=">"==e.current()&&findMatchingMode(n[s[1]],s[2]),d=CodeMirror.getMode(t,g),u=getTagRegexp(s[1],!0),m=getTagRegexp(s[1],!1);r.token=function(t,e){return t.match(u,!1)?(e.token=i,e.localState=e.localMode=null,null):maybeBackup(t,m,e.localMode.token(t,e.localState))},r.localMode=d,r.localState=CodeMirror.startState(d,a.indent(r.htmlState,"",""))}else r.inTag&&(r.inTag+=e.current(),e.eol()&&(r.inTag+=" "));return o}return{startState:function(){return{token:i,inTag:null,localMode:null,localState:null,htmlState:CodeMirror.startState(a)}},copyState:function(t){var e;return t.localState&&(e=CodeMirror.copyState(t.localMode,t.localState)),{token:t.token,inTag:t.inTag,localMode:t.localMode,localState:e,htmlState:CodeMirror.copyState(a,t.htmlState)}},token:function(t,e){return e.token(t,e)},indent:function(t,e,n){return!t.localMode||/^\s*<\//.test(e)?a.indent(t.htmlState,e,n):t.localMode.indent?t.localMode.indent(t.localState,e,n):CodeMirror.Pass},innerMode:function(t){return{state:t.localState||t.htmlState,mode:t.localMode||a}}}},"xml","javascript","css"),CodeMirror.defineMIME("text/html","htmlmixed");
//# sourceMappingURL=htmlmixed.js.map